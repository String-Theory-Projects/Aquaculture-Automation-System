openapi: 3.0.3
info:
  title: Future Fish Dashboard API
  description: |
    Comprehensive API documentation for the Future Fish Dashboard project.
    
    This API provides endpoints for:
    - Automation management (thresholds, schedules, execution)
    - Pond management and monitoring
    - User authentication and profiles
    - Analytics and data visualization
    - Device control and monitoring
    
    ## Project Phases
    - **Phase 1**: Core infrastructure and basic pond management
    - **Phase 2**: User authentication and basic automation
    - **Phase 3**: Advanced automation and scheduling
    - **Phase 4**: Analytics and reporting
    - **Phase 5**: Device control and real-time monitoring
    
    ## üîê Authentication Setup
    
    ### Step 1: Get Your JWT Token
    1. Use the authentication endpoints to login/register
    2. Copy the JWT token from the response
    
    ### Step 2: Configure Authorization
    1. Click the **"Authorize"** button at the top of this page
    2. Enter your token in the format: `Bearer <your_jwt_token>`
    3. Click **"Authorize"** to save
    
    ### Step 3: Test Endpoints
    - All authenticated endpoints will now automatically include your token
    - You can also manually add the header: `Authorization: Bearer <your_jwt_token>`
    
    ## üìç Base URLs
    - **Development**: `http://localhost:8000`
    - **Production**: `https://app.futurefishagro.com`
    
    ## ‚ö° Rate Limiting
    API requests are limited to 100 requests per hour per user.
    
    ## üìö Documentation Updates
    This documentation is updated with each project phase completion to reflect new endpoints and features.
    
    ## üöÄ Quick Start
    1. **Authorize** using the button above
    2. **Select a server** from the dropdown
    3. **Browse endpoints** by category
    4. **Test endpoints** with the "Try it out" button
  
  version: 1.0.0
  contact:
    name: Future Fish Farms Engineering Team
    email: engineering@futurefishagro.com
    url: https://futurefishagro.com
  
  license:
    name: Proprietary
    url: https://futurefishagro.com/license

servers:
  - url: http://localhost:8000
    description: Development server
    variables:
      baseUrl:
        default: http://localhost:8000
        description: Base URL for the API
  - url: https://app.futurefishagro.com
    description: Production server
    variables:
      baseUrl:
        default: https://app.futurefishagro.com
        description: Base URL for the API

security:
  - BearerAuth: [eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzYxNjgxMzg2LCJpYXQiOjE3NTY0OTczODYsImp0aSI6IjQ4MWM1NDk1ZjEyNTQ3MTBiZGZiY2IxYTQ1NGYxNzljIiwidXNlcl9pZCI6MX0.74W5FvVkUvxujLNoLNV6nFyjc4LFt43ZDoB8ibZtZmA]

# Global parameters for common values
parameters:
  Authorization:
    name: Authorization
    in: header
    required: true
    description: JWT Bearer token for authentication
    schema:
      type: string
      example: "Bearer <your_jwt_token>"
    x-example: "Bearer eyJ0eXAiOiJKV1QiLCJIUzI1NiJ9..."
    x-parameter-location: header

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT token obtained from authentication endpoints.
        
        **How to use:**
        1. Get your JWT token from the authentication endpoints
        2. Include it in the Authorization header as: `Bearer <your_token>`
        3. All authenticated endpoints will automatically use this token
        
        **Example:**
        ```
        Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
        ```
        
        **Note:** Replace `<your_token>` with the actual JWT token received from login/authentication
  
  schemas:
    # Common Response Schemas
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: Response data
        message:
          type: string
          description: Success message
          example: "Operation completed successfully"
    
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          description: Error message
          example: "Invalid request parameters"
        error_code:
          type: string
          description: Error code for programmatic handling
          example: "VALIDATION_ERROR"
        details:
          type: object
          description: Additional error details
    
    PaginatedResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: array
          items:
            type: object
        count:
          type: integer
          description: Total number of items
          example: 25
        next:
          type: string
          description: URL for next page
          example: "http://localhost:8000/api/v1/automation/ponds/1/thresholds/?page=2"
        previous:
          type: string
          description: URL for previous page
          example: "http://localhost:8000/api/v1/automation/ponds/1/thresholds/?page=1"
    
    # Automation Schemas
    AutomationExecution:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        execution_type:
          type: string
          enum: [FEED, WATER]
          description: Type of automation
          example: "FEED"
        action:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, ALERT, NOTIFICATION, LOG]
          description: Specific action to perform
          example: "FEED"
        priority:
          type: string
          enum: [MANUAL_COMMAND, EMERGENCY_WATER, SCHEDULED, THRESHOLD]
          description: Execution priority
          example: "SCHEDULED"
        status:
          type: string
          enum: [PENDING, EXECUTING, COMPLETED, FAILED, CANCELLED]
          description: Current execution status
          example: "COMPLETED"
        scheduled_at:
          type: string
          format: date-time
          description: When execution was scheduled
          example: "2024-01-15T10:00:00Z"
        started_at:
          type: string
          format: date-time
          description: When execution started
          example: "2024-01-15T10:00:00Z"
        completed_at:
          type: string
          format: date-time
          description: When execution completed
          example: "2024-01-15T10:05:00Z"
        parameters:
          type: object
          description: Execution parameters
          example: {"feed_amount": 100, "water_level": 80}
        success:
          type: boolean
          description: Whether execution was successful
          example: true
        result_message:
          type: string
          description: Result description
          example: "Feed dispensed successfully"
        error_details:
          type: string
          description: Error details if execution failed
          example: null
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-15T09:55:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T10:05:00Z"
    
    DeviceCommand:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        command_type:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, SET_THRESHOLD, FIRMWARE_UPDATE, RESTART, CONFIG_UPDATE]
          description: Type of command
          example: "FEED"
        status:
          type: string
          enum: [PENDING, SENT, ACKNOWLEDGED, COMPLETED, FAILED, TIMEOUT]
          description: Command status
          example: "COMPLETED"
        command_id:
          type: string
          format: uuid
          description: Unique command identifier
          example: "550e8400-e29b-41d4-a716-446655440000"
        parameters:
          type: object
          description: Command parameters
          example: {"feed_amount": 100}
        sent_at:
          type: string
          format: date-time
          description: When command was sent
          example: "2024-01-15T10:00:00Z"
        acknowledged_at:
          type: string
          format: date-time
          description: When command was acknowledged
          example: "2024-01-15T10:00:05Z"
        completed_at:
          type: string
          format: date-time
          description: When command completed
          example: "2024-01-15T10:00:15Z"
        timeout_seconds:
          type: integer
          description: Command timeout in seconds
          example: 10
        max_retries:
          type: integer
          description: Maximum retry attempts
          example: 3
        retry_count:
          type: integer
          description: Current retry count
          example: 0
        success:
          type: boolean
          description: Whether command was successful
          example: true
        result_message:
          type: string
          description: Result description
          example: "Command executed successfully"
        error_code:
          type: string
          description: Error code if command failed
          example: null
        error_details:
          type: string
          description: Error details if command failed
          example: null
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-15T09:55:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T10:00:15Z"
    
    AutomationSchedule:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        automation_type:
          type: string
          enum: [FEED, WATER]
          description: Type of automation
          example: "FEED"
        action:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE]
          description: Specific action to perform when this schedule executes
          example: "FEED"
        is_active:
          type: boolean
          description: Whether schedule is active
          example: true
        time:
          type: string
          format: time
          description: Time of day for execution
          example: "10:00:00"
        days:
          type: string
          description: Days of week (comma-separated day numbers, 0=Sunday)
          example: "1,2,3,4,5"
        feed_amount:
          type: number
          format: float
          description: Feed amount in grams
          example: 100.0
        drain_water_level:
          type: number
          format: float
          description: Water level to drain to (percentage)
          example: 0.0
        target_water_level:
          type: number
          format: float
          description: Target water level percentage to refill to
          example: 80.0
        priority:
          type: integer
          minimum: 1
          maximum: 5
          description: Priority level (1=highest, 5=lowest)
          example: 3
        last_execution:
          type: string
          format: date-time
          description: Last execution timestamp
          example: "2024-01-15T10:00:00Z"
        next_execution:
          type: string
          format: date-time
          description: Next scheduled execution
          example: "2024-01-16T10:00:00Z"
        execution_count:
          type: integer
          description: Total execution count
          example: 15
        user:
          type: integer
          description: User ID who created the schedule
          example: 1
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T10:00:00Z"
    
    SensorThreshold:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        parameter:
          type: string
          enum: [temperature, water_level, feed_level, turbidity, dissolved_oxygen, ph, ammonia, battery]
          description: Sensor parameter to monitor
          example: "temperature"
        upper_threshold:
          type: number
          format: float
          description: Upper threshold value
          example: 30.0
        lower_threshold:
          type: number
          format: float
          description: Lower threshold value
          example: 20.0
        automation_action:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, ALERT, NOTIFICATION, LOG]
          description: Action to take when threshold is violated
          example: "ALERT"
        priority:
          type: integer
          minimum: 1
          maximum: 5
          description: Priority level (1=highest, 5=lowest)
          example: 2
        alert_level:
          type: string
          enum: [LOW, MEDIUM, HIGH, CRITICAL]
          description: Alert severity level
          example: "MEDIUM"
        is_active:
          type: boolean
          description: Whether threshold is active
          example: true
        violation_timeout:
          type: integer
          description: Timeout in seconds before triggering action
          example: 30
        max_violations:
          type: integer
          description: Maximum violations before triggering action
          example: 3
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T10:00:00Z"
    
    FeedEvent:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        user:
          type: integer
          description: User ID who logged the feed event
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        amount:
          type: number
          format: float
          description: Feed amount in kilograms
          example: 0.1
        timestamp:
          type: string
          format: date-time
          description: When feed event occurred
          example: "2024-01-15T10:00:00Z"
    
    FeedStat:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier
          example: 1
        user:
          type: integer
          description: User ID
          example: 1
        pond:
          type: integer
          description: Pond ID
          example: 1
        stat_type:
          type: string
          enum: [daily, weekly, monthly, yearly]
          description: Statistics period type
          example: "daily"
        amount:
          type: number
          format: float
          description: Total feed amount for the period
          example: 0.5
        start_date:
          type: string
          format: date
          description: Start date of the statistics period
          example: "2024-01-15"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T23:59:59Z"
    
    UserProfile:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier for the user
          example: 1
        username:
          type: string
          description: Unique username for the user
          example: "john_doe"
        email:
          type: string
          format: email
          description: User's email address
          example: "john@example.com"
        first_name:
          type: string
          description: User's first name
          example: "John"
        last_name:
          type: string
          description: User's last name
          example: "Doe"
        phone:
          type: string
          description: User's phone number
          example: "+1234567890"
        company:
          type: string
          description: User's company or organization
          example: "Future Fish Farms"
        role:
          type: string
          description: User's role or job title
          example: "Farm Manager"
        date_joined:
          type: string
          format: date-time
          description: Timestamp when the user account was created
          example: "2024-01-15T10:30:00Z"
        last_login:
          type: string
          format: date-time
          description: Timestamp of the user's last login
          example: "2024-08-29T15:45:00Z"
        is_active:
          type: boolean
          description: Whether the user account is active
          example: true
        preferences:
          type: object
          properties:
            notifications_enabled:
              type: boolean
              description: Whether notifications are enabled
              example: true
            theme:
              type: string
              description: UI theme preference
              enum: ["light", "dark", "auto"]
              example: "dark"
            language:
              type: string
              description: Language preference
              enum: ["en", "es", "fr"]
              example: "en"
          description: User preferences and settings
      required:
        - id
        - username
        - email
        - date_joined
        - is_active
    
    Pond:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier for the pond
          example: 1
        name:
          type: string
          description: Name of the pond
          example: "Main Production Pond"
        description:
          type: string
          description: Detailed description of the pond
          example: "Primary fish production pond with automated feeding system"
        status:
          type: string
          description: Current status of the pond
          enum: ["active", "inactive", "maintenance", "harvested"]
          example: "active"
        area:
          type: number
          format: float
          description: Surface area of the pond in square meters
          example: 1000.0
        depth:
          type: number
          format: float
          description: Average depth of the pond in meters
          example: 2.5
        fish_count:
          type: integer
          description: Current number of fish in the pond
          example: 5000
        water_quality:
          type: object
          properties:
            temperature:
              type: number
              format: float
              description: Water temperature in Celsius
              example: 28.5
            ph:
              type: number
              format: float
              description: pH level
              example: 7.2
            dissolved_oxygen:
              type: number
              format: float
              description: Dissolved oxygen in mg/L
              example: 6.8
            ammonia:
              type: number
              format: float
              description: Ammonia level in mg/L
              example: 0.02
          description: Current water quality parameters
        created_at:
          type: string
          format: date-time
          description: Timestamp when the pond was created
          example: "2024-01-15T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: Timestamp when the pond was last updated
          example: "2024-08-29T15:45:00Z"
      required:
        - id
        - name
        - status
        - area
        - depth
        - created_at
        - updated_at
    
    # Common Request Schemas
    CreateThresholdRequest:
      type: object
      required:
        - parameter
        - upper_threshold
        - lower_threshold
        - automation_action
      properties:
        parameter:
          type: string
          enum: [temperature, water_level, feed_level, turbidity, dissolved_oxygen, ph, ammonia, battery]
          description: Sensor parameter to monitor
          example: "temperature"
        upper_threshold:
          type: number
          format: float
          description: Upper threshold value
          example: 30.0
        lower_threshold:
          type: number
          format: float
          description: Lower threshold value
          example: 20.0
        automation_action:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, ALERT, NOTIFICATION, LOG]
          description: Action to take when threshold is violated
          example: "ALERT"
        priority:
          type: integer
          minimum: 1
          maximum: 5
          description: Priority level (1=highest, 5=lowest)
          example: 2
        alert_level:
          type: string
          enum: [LOW, MEDIUM, HIGH, CRITICAL]
          description: Alert severity level
          example: "MEDIUM"
        violation_timeout:
          type: integer
          description: Timeout in seconds before triggering action
          example: 30
        max_violations:
          type: integer
          description: Maximum violations before triggering action
          example: 3
        send_alert:
          type: boolean
          description: Whether to send alert when threshold is violated
          example: true
    
    CreateScheduleRequest:
      type: object
      required:
        - automation_type
        - action
        - time
        - days
      properties:
        automation_type:
          type: string
          enum: [FEED, WATER]
          description: Type of automation
          example: "FEED"
        action:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE]
          description: Specific action to perform when this schedule executes
          example: "FEED"
        time:
          type: string
          format: time
          description: Time of day for execution (HH:MM:SS)
          example: "10:00:00"
        days:
          type: string
          description: Days of week (comma-separated day numbers, 0=Sunday)
          example: "1,2,3,4,5"
        amount:
          type: number
          format: float
          description: Feed amount in grams (required for FEED type)
          example: 100.0
        drain_level:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Water level to drain to (percentage, required for WATER type)
          example: 0.0
        target_level:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Target water level percentage to refill to (required for WATER type)
          example: 80.0
        priority:
          type: integer
          minimum: 1
          maximum: 5
          description: Priority level (1=highest, 5=lowest)
          example: 3
    
    ExecuteCommandRequest:
      type: object
      required:
        - command_type
      properties:
        command_type:
          type: string
          enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, SET_THRESHOLD, FIRMWARE_UPDATE, RESTART, CONFIG_UPDATE]
          description: Type of command to execute
          example: "FEED"
        parameters:
          type: object
          description: Command-specific parameters
          example: {"feed_amount": 100, "water_level": 80}
        timeout_seconds:
          type: integer
          description: Command timeout in seconds
          example: 10
        max_retries:
          type: integer
          description: Maximum retry attempts
          example: 3
    
    # Error Schemas
    ValidationError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Validation error"
        error_code:
          type: string
          example: "VALIDATION_ERROR"
        details:
          type: object
          properties:
            field_name:
              type: array
              items:
                type: string
              example: ["This field is required."]
    
    AuthenticationError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Authentication required"
        error_code:
          type: string
          example: "AUTHENTICATION_REQUIRED"
    
    PermissionError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Access denied"
        error_code:
          type: string
          example: "PERMISSION_DENIED"
    
    NotFoundError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Resource not found"
        error_code:
          type: string
          example: "NOT_FOUND"
    
    ServerError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Internal server error"
        error_code:
          type: string
          example: "INTERNAL_ERROR"

paths:
  # =============================================================================
  # AUTHENTICATION ENDPOINTS (Get Your JWT Token)
  # =============================================================================
  
  /auth/token/:
    post:
      tags:
        - Authentication
      summary: Get JWT access token
      description: |
        **üîë Use this endpoint to get your JWT token for API access**
        
        This endpoint authenticates users and returns JWT tokens for API access.
        
        **Steps:**
        1. Use this endpoint to login with your credentials
        2. Copy the `access` token from the response
        3. Use the token in the Authorization header: `Bearer <access_token>`
        
        **Note:** The `refresh` token can be used to get new access tokens when they expire.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  description: Your username or email
                  example: "user@example.com"
                password:
                  type: string
                  description: Your password
                  example: "your_password"
            examples:
              login_example:
                summary: Standard login
                value:
                  username: "user@example.com"
                  password: "your_password"
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access:
                    type: string
                    description: JWT access token (use this for API calls)
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                  refresh:
                    type: string
                    description: JWT refresh token (use this to get new access tokens)
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: User ID
                        example: 1
                      username:
                        type: string
                        description: Username
                        example: "user@example.com"
                      email:
                        type: string
                        description: User email
                        example: "user@example.com"
              examples:
                success:
                  summary: Successful authentication
                  value:
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    user:
                      id: 1
                      username: "user@example.com"
                      email: "user@example.com"
        '400':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "No active account found with the given credentials"
        '401':
          description: Authentication failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "No active account found with the given credentials"
  
  /auth/token/refresh/:
    post:
      tags:
        - Authentication
      summary: Refresh JWT access token
      description: |
        **üîÑ Use this endpoint to get a new access token when the current one expires**
        
        This endpoint uses your refresh token to get a new access token without re-authenticating.
        
        **Steps:**
        1. Use your `refresh` token from the login response
        2. Get a new `access` token
        3. Continue using the API with the new token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refresh
              properties:
                refresh:
                  type: string
                  description: Your refresh token
                  example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
            examples:
              refresh_example:
                summary: Refresh token
                value:
                  refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access:
                    type: string
                    description: New JWT access token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
              examples:
                success:
                  summary: Successful token refresh
                  value:
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
        '400':
          description: Invalid refresh token
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "Token is invalid or expired"
  
  /auth/register/:
    post:
      tags:
        - Authentication
      summary: Register new user
      description: |
        **üìù Use this endpoint to create a new user account**
        
        This endpoint allows new users to register for the system.
        
        **Steps:**
        1. Create your account with this endpoint
        2. Use the login endpoint to get your JWT token
        3. Start using the API with authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
                - password2
              properties:
                username:
                  type: string
                  description: Choose a unique username
                  example: "newuser"
                email:
                  type: string
                  format: email
                  description: Your email address
                  example: "newuser@example.com"
                password:
                  type: string
                  description: Choose a secure password
                  example: "secure_password123"
                password2:
                  type: string
                  description: Confirm your password
                  example: "secure_password123"
            examples:
              register_example:
                summary: New user registration
                value:
                  username: "newuser"
                  email: "newuser@example.com"
                  password: "secure_password123"
                  password2: "secure_password123"
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    description: Success message
                    example: "User registered successfully"
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: New user ID
                        example: 2
                      username:
                        type: string
                        description: Username
                        example: "newuser"
                      email:
                        type: string
                        description: Email
                        example: "newuser@example.com"
              examples:
                success:
                  summary: Successful registration
                  value:
                    success: true
                    message: "User registered successfully"
                    user:
                      id: 2
                      username: "newuser"
                      email: "newuser@example.com"
        '400':
          description: Registration failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    description: Error message
                    example: "Username already exists"
  
  # =============================================================================
  # AUTOMATION ENDPOINTS
  # =============================================================================
  
  # Threshold Management
  /automation/ponds/{pond_id}/thresholds/:
    get:
      tags:
        - Automation - Thresholds
      summary: Get active thresholds for a pond
      description: |
        Retrieve all active sensor thresholds for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Response:** List of active thresholds with their configuration and status.
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: page
          in: query
          required: false
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: page_size
          in: query
          required: false
          description: Number of items per page (max 200)
          schema:
            type: integer
            minimum: 1
            maximum: 200
            example: 50
      responses:
        '200':
          description: Successfully retrieved thresholds
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/SensorThreshold'
                      count:
                        type: integer
                        description: Total number of thresholds
                        example: 5
              examples:
                success:
                  summary: Successful response
                  value:
                    success: true
                    data:
                      - id: 1
                        pond: 1
                        parameter: "temperature"
                        upper_threshold: 30.0
                        lower_threshold: 20.0
                        automation_action: "ALERT"
                        priority: 2
                        alert_level: "MEDIUM"
                        is_active: true
                        violation_timeout: 30
                        max_violations: 3
                        created_at: "2024-01-01T00:00:00Z"
                        updated_at: "2024-01-15T10:00:00Z"
                    count: 1
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
    
    post:
      tags:
        - Automation - Thresholds
      summary: Create a new sensor threshold
      description: |
        Create a new sensor threshold for monitoring and automation.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Required Fields:** parameter, upper_threshold, lower_threshold, automation_action
        
        **Automation Actions Available:**
        - `FEED`: Trigger feeding automation
        - `WATER_DRAIN`: Drain water from pond
        - `WATER_FILL`: Fill pond with water
        - `WATER_FLUSH`: Flush pond water
        - `WATER_INLET_OPEN/CLOSE`: Control water inlet valve
        - `WATER_OUTLET_OPEN/CLOSE`: Control water outlet valve
        - `ALERT`: Send alert notification
        - `NOTIFICATION`: Send general notification
        - `LOG`: Log event for monitoring
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateThresholdRequest'
            examples:
              temperature_threshold:
                summary: Temperature threshold example
                value:
                  parameter: "temperature"
                  upper_threshold: 30.0
                  lower_threshold: 20.0
                  automation_action: "ALERT"
                  priority: 2
                  alert_level: "MEDIUM"
                  violation_timeout: 30
                  max_violations: 3
                  send_alert: true
              water_level_threshold:
                summary: Water level threshold example
                value:
                  parameter: "water_level"
                  upper_threshold: 95.0
                  lower_threshold: 20.0
                  automation_action: "WATER_DRAIN"
                  priority: 1
                  alert_level: "HIGH"
                  violation_timeout: 60
                  max_violations: 2
                  send_alert: true
      responses:
        '201':
          description: Threshold created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            description: ID of the created threshold
                            example: 1
                          message:
                            type: string
                            description: Success message
                            example: "Threshold created successfully for temperature"
              examples:
                success:
                  summary: Successful creation
                  value:
                    success: true
                    data:
                      id: 1
                      message: "Threshold created successfully for temperature"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                missing_field:
                  summary: Missing required field
                  value:
                    success: false
                    error: "Missing required field: parameter"
                invalid_value:
                  summary: Invalid numeric value
                  value:
                    success: false
                    error: "Invalid numeric value: upper_threshold must be greater than lower_threshold"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/thresholds/{threshold_id}/update/:
    put:
      tags:
        - Automation - Thresholds
      summary: Update an existing sensor threshold
      description: |
        Update an existing sensor threshold configuration.
        
        **Permissions Required:** User must own the pond pair containing this threshold.
        
        **Note:** Only include the fields you want to update. All fields are optional for updates.
      parameters:
        - name: threshold_id
          in: path
          required: true
          description: Unique identifier of the threshold to update
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameter:
                  type: string
                  enum: [temperature, water_level, feed_level, turbidity, dissolved_oxygen, ph, ammonia, battery]
                  description: Sensor parameter to monitor
                  example: "temperature"
                upper_threshold:
                  type: number
                  format: float
                  description: Upper threshold value
                  example: 32.0
                lower_threshold:
                  type: number
                  format: float
                  description: Lower threshold value
                  example: 18.0
                automation_action:
                  type: string
                  enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, ALERT, NOTIFICATION, LOG]
                  description: Action to take when threshold is violated
                  example: "ALERT"
                priority:
                  type: integer
                  minimum: 1
                  maximum: 5
                  description: Priority level (1=highest, 5=lowest)
                  example: 1
                alert_level:
                  type: string
                  enum: [LOW, MEDIUM, HIGH, CRITICAL]
                  description: Alert severity level
                  example: "HIGH"
                is_active:
                  type: boolean
                  description: Whether threshold is active
                  example: true
                violation_timeout:
                  type: integer
                  description: Timeout in seconds before triggering action
                  example: 45
                max_violations:
                  type: integer
                  description: Maximum violations before triggering action
                  example: 2
            examples:
              update_temperature:
                summary: Update temperature threshold
                value:
                  upper_threshold: 32.0
                  lower_threshold: 18.0
                  priority: 1
                  alert_level: "HIGH"
                  violation_timeout: 45
      responses:
        '200':
          description: Threshold updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/SensorThreshold'
              examples:
                success:
                  summary: Successful update
                  value:
                    success: true
                    data:
                      id: 1
                      pond: 1
                      parameter: "temperature"
                      upper_threshold: 32.0
                      lower_threshold: 18.0
                      automation_action: "ALERT"
                      priority: 1
                      alert_level: "HIGH"
                      is_active: true
                      violation_timeout: 45
                      max_violations: 2
                      created_at: "2024-01-01T00:00:00Z"
                      updated_at: "2024-01-15T11:00:00Z"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Threshold not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/thresholds/{threshold_id}/delete/:
    delete:
      tags:
        - Automation - Thresholds
      summary: Delete a sensor threshold
      description: |
        Delete an existing sensor threshold.
        
        **Permissions Required:** User must own the pond pair containing this threshold.
        
        **Warning:** This action cannot be undone. The threshold will be permanently removed.
      parameters:
        - name: threshold_id
          in: path
          required: true
          description: Unique identifier of the threshold to delete
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Threshold deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      message:
                        type: string
                        description: Success message
                        example: "Threshold deleted successfully"
              examples:
                success:
                  summary: Successful deletion
                  value:
                    success: true
                    message: "Threshold deleted successfully"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Threshold not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # Automation Schedules
  /automation/ponds/{pond_id}/schedules/:
    get:
      tags:
        - Automation - Schedules
      summary: Get automation schedules for a pond
      description: |
        Retrieve all automation schedules for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Response:** List of automation schedules with their configuration and status.
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: automation_type
          in: query
          required: false
          description: Filter by automation type
          schema:
            type: string
            enum: [FEED, WATER]
            example: "FEED"
        - name: is_active
          in: query
          required: false
          description: Filter by active status
          schema:
            type: boolean
            example: true
        - name: page
          in: query
          required: false
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: page_size
          in: query
          required: false
          description: Number of items per page (max 200)
          schema:
            type: integer
            minimum: 1
            maximum: 200
            example: 50
      responses:
        '200':
          description: Successfully retrieved schedules
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/AutomationSchedule'
                      count:
                        type: integer
                        description: Total number of schedules
                        example: 3
              examples:
                success:
                  summary: Successful response
                  value:
                    success: true
                    data:
                      - id: 1
                        pond: 1
                        automation_type: "FEED"
                        action: "FEED"
                        is_active: true
                        time: "10:00:00"
                        days: "1,2,3,4,5"
                        feed_amount: 100.0
                        priority: 3
                        last_execution: "2024-01-15T10:00:00Z"
                        next_execution: "2024-01-16T10:00:00Z"
                        execution_count: 15
                        user: 1
                        created_at: "2024-01-01T00:00:00Z"
                        updated_at: "2024-01-15T10:00:00Z"
                    count: 1
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/schedules/create/:
    post:
      tags:
        - Automation - Schedules
      summary: Create a new automation schedule
      description: |
        Create a new automation schedule for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Required Fields:** automation_type, action, time, days
        
        **Schedule Types:**
        - `FEED`: Requires action="FEED" and amount parameter
        - `WATER`: Requires water-related action (WATER_DRAIN, WATER_FILL, etc.) and either drain_level or target_level
        
        **Action Validation:**
        - FEED automation can only use action="FEED"
        - WATER automation can use: WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE
        
        **Days Format:** Comma-separated day numbers where 0=Sunday, 1=Monday, etc.
        Example: "1,2,3,4,5" for weekdays only
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateScheduleRequest'
            examples:
              feed_schedule:
                summary: Daily feeding schedule
                value:
                  automation_type: "FEED"
                  action: "FEED"
                  time: "10:00:00"
                  days: "1,2,3,4,5,6,7"
                  amount: 100.0
                  priority: 3
              water_schedule:
                summary: Weekly water change schedule
                value:
                  automation_type: "WATER"
                  action: "WATER_DRAIN"
                  time: "06:00:00"
                  days: "1"
                  drain_level: 0.0
                  target_level: 80.0
                  priority: 2
      responses:
        '201':
          description: Schedule created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AutomationSchedule'
              examples:
                success:
                  summary: Successful creation
                  value:
                    success: true
                    data:
                      id: 1
                      pond: 1
                      automation_type: "FEED"
                      is_active: true
                      time: "10:00:00"
                      days: "1,2,3,4,5,6,7"
                      amount: 100.0
                      priority: 3
                      user: 1
                      created_at: "2024-01-15T12:00:00Z"
                      updated_at: "2024-01-15T12:00:00Z"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                missing_amount:
                  summary: Missing amount for FEED type
                  value:
                    success: false
                    error: "Amount is required for feeding automation"
                missing_water_params:
                  summary: Missing water parameters for WATER type
                  value:
                    success: false
                    error: "Either drain_level or target_level must be specified for water automation"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/schedules/{schedule_id}/:
    get:
      tags:
        - Automation - Schedules
      summary: Get automation schedule details
      description: |
        Retrieve detailed information about a specific automation schedule.
        
        **Permissions Required:** User must own the pond pair containing this schedule.
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: schedule_id
          in: path
          required: true
          description: Unique identifier of the schedule
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Successfully retrieved schedule details
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AutomationSchedule'
              examples:
                success:
                  summary: Successful response
                  value:
                    success: true
                    data:
                      id: 1
                      pond: 1
                      automation_type: "FEED"
                      action: "FEED"
                      is_active: true
                      time: "10:00:00"
                      days: "1,2,3,4,5,6,7"
                      feed_amount: 100.0
                      priority: 3
                      last_execution: "2024-01-15T10:00:00Z"
                      next_execution: "2024-01-16T10:00:00Z"
                      execution_count: 15
                      user: 1
                      created_at: "2024-01-01T00:00:00Z"
                      updated_at: "2024-01-15T10:00:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Schedule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
    
    put:
      tags:
        - Automation - Schedules
      summary: Update automation schedule
      description: |
        Update an existing automation schedule.
        
        **Permissions Required:** User must own the pond pair containing this schedule.
        
        **Note:** Only include the fields you want to update. All fields are optional for updates.
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: schedule_id
          in: path
          required: true
          description: Unique identifier of the schedule
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                automation_type:
                  type: string
                  enum: [FEED, WATER]
                  description: Type of automation
                  example: "FEED"
                time:
                  type: string
                  format: time
                  description: Time of day for execution (HH:MM:SS)
                  example: "11:00:00"
                days:
                  type: string
                  description: Days of week (comma-separated day numbers, 0=Sunday)
                  example: "1,2,3,4,5"
                feed_amount:
                  type: number
                  format: float
                  description: Feed amount in grams (required for FEED type)
                  example: 150.0
                drain_water_level:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 100
                  description: Water level to drain to (percentage, required for WATER type)
                  example: 0.0
                target_water_level:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 100
                  description: Target water level percentage to refill to (required for WATER type)
                  example: 85.0
                priority:
                  type: integer
                  minimum: 1
                  maximum: 5
                  description: Priority level (1=highest, 5=lowest)
                  example: 2
                is_active:
                  type: boolean
                  description: Whether schedule is active
                  example: true
            examples:
              update_feed_schedule:
                summary: Update feed schedule
                value:
                  time: "11:00:00"
                  feed_amount: 150.0
                  priority: 2
              update_water_schedule:
                summary: Update water schedule
                value:
                  time: "07:00:00"
                  target_water_level: 85.0
                  priority: 1
      responses:
        '200':
          description: Schedule updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AutomationSchedule'
              examples:
                success:
                  summary: Successful update
                  value:
                    success: true
                    data:
                      id: 1
                      pond: 1
                      automation_type: "FEED"
                      is_active: true
                      time: "11:00:00"
                      days: "1,2,3,4,5"
                      feed_amount: 150.0
                      priority: 2
                      last_execution: "2024-01-15T10:00:00Z"
                      next_execution: "2024-01-16T11:00:00Z"
                      execution_count: 15
                      user: 1
                      created_at: "2024-01-01T00:00:00Z"
                      updated_at: "2024-01-15T12:00:00Z"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Schedule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/schedules/{schedule_id}/delete/:
    delete:
      tags:
        - Automation - Schedules
      summary: Delete automation schedule
      description: |
        Delete an existing automation schedule.
        
        **Permissions Required:** User must own the pond pair containing this schedule.
        
        **Warning:** This action cannot be undone. The schedule will be permanently removed.
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: schedule_id
          in: path
          required: true
          description: Unique identifier of the schedule
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Schedule deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      message:
                        type: string
                        description: Success message
                        example: "Schedule deleted successfully"
              examples:
                success:
                  summary: Successful deletion
                  value:
                    success: true
                    message: "Schedule deleted successfully"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Schedule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Automation Execution
  /automation/ponds/{pond_id}/execute/:
    post:
      tags:
        - Automation - Execution
      summary: Execute manual automation
      description: |
        Manually execute an automation action for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Available Actions:**
        - `FEED`: Dispense feed (requires feed_amount parameter)
        - `WATER_DRAIN`: Drain water (requires drain_level parameter)
        - `WATER_FILL`: Fill water (requires target_level parameter)
        - `WATER_FLUSH`: Flush water system
        - `WATER_INLET_OPEN/CLOSE`: Control inlet valve
        - `WATER_OUTLET_OPEN/CLOSE`: Control outlet valve
        
        **Priority Levels:**
        - `MANUAL_COMMAND`: Highest priority, immediate execution
        - `EMERGENCY_WATER`: Critical water management
        - `SCHEDULED`: Regular scheduled operations
        - `THRESHOLD`: Sensor-triggered actions
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - execution_type
                - action
              properties:
                execution_type:
                  type: string
                  enum: [FEED, WATER]
                  description: Type of automation to execute
                  example: "FEED"
                action:
                  type: string
                  enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE]
                  description: Specific action to perform
                  example: "FEED"
                priority:
                  type: string
                  enum: [MANUAL_COMMAND, EMERGENCY_WATER, SCHEDULED, THRESHOLD]
                  description: Execution priority
                  example: "MANUAL_COMMAND"
                parameters:
                  type: object
                  description: Action-specific parameters
                  example: {"feed_amount": 100, "water_level": 80}
                scheduled_at:
                  type: string
                  format: date-time
                  description: When to execute (null for immediate)
                  example: null
            examples:
              manual_feed:
                summary: Manual feeding
                value:
                  execution_type: "FEED"
                  action: "FEED"
                  priority: "MANUAL_COMMAND"
                  parameters: {"feed_amount": 150}
              water_drain:
                summary: Emergency water drain
                value:
                  execution_type: "WATER"
                  action: "WATER_DRAIN"
                  priority: "EMERGENCY_WATER"
                  parameters: {"drain_level": 0}
              scheduled_water_fill:
                summary: Scheduled water fill
                value:
                  execution_type: "WATER"
                  action: "WATER_FILL"
                  priority: "SCHEDULED"
                  parameters: {"target_level": 85}
                  scheduled_at: "2024-01-15T14:00:00Z"
      responses:
        '200':
          description: Automation execution started successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          execution_id:
                            type: integer
                            description: ID of the created execution
                            example: 1
                          message:
                            type: string
                            description: Success message
                            example: "Feed automation execution started"
                          status:
                            type: string
                            enum: [PENDING, EXECUTING, COMPLETED, FAILED, CANCELLED]
                            description: Current execution status
                            example: "PENDING"
                          scheduled_at:
                            type: string
                            format: date-time
                            description: When execution will occur
                            example: "2024-01-15T14:00:00Z"
              examples:
                success:
                  summary: Successful execution start
                  value:
                    success: true
                    data:
                      execution_id: 1
                      message: "Feed automation execution started"
                      status: "PENDING"
                      scheduled_at: "2024-01-15T14:00:00Z"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                missing_parameters:
                  summary: Missing required parameters
                  value:
                    success: false
                    error: "Missing required parameters for FEED action"
                invalid_priority:
                  summary: Invalid priority level
                  value:
                    success: false
                    error: "Invalid priority level specified"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # Device Control Commands
  /automation/ponds/{pond_id}/control/feed/:
    post:
      tags:
        - Automation - Device Control
      summary: Execute feed command
      description: |
        Send a feed command to the pond device.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Command Details:**
        - Command is sent to the device via MQTT
        - Device acknowledges receipt and executes
        - Status is tracked until completion
        - Retry mechanism handles failures
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - amount
              properties:
                amount:
                  type: number
                  format: float
                  minimum: 0.1
                  maximum: 1000
                  description: Amount of feed to dispense (in grams)
                  example: 100.0
            examples:
              standard_feed:
                summary: Standard feeding
                value:
                  amount: 100.0
              large_feed:
                summary: Large feeding
                value:
                  amount: 500.0
      responses:
        '200':
          description: Feed command sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          command_id:
                            type: string
                            format: uuid
                            description: Unique command identifier
                            example: "550e8400-e29b-41d4-a716-446655440000"
                          message:
                            type: string
                            description: Success message
                            example: "Feed command sent successfully"
                          status:
                            type: string
                            enum: [PENDING, SENT, ACKNOWLEDGED, COMPLETED, FAILED, TIMEOUT]
                            description: Current command status
                            example: "SENT"
                          feed_amount:
                            type: number
                            format: float
                            description: Feed amount in grams
                            example: 100.0
              examples:
                success:
                  summary: Successful command
                  value:
                    success: true
                    data:
                      command_id: "550e8400-e29b-41d4-a716-446655440000"
                      message: "Feed command sent successfully"
                      status: "SENT"
                      feed_amount: 100.0
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                invalid_amount:
                  summary: Invalid feed amount
                  value:
                    success: false
                    error: "Feed amount must be between 10 and 1000 grams"
                invalid_timeout:
                  summary: Invalid timeout
                  value:
                    success: false
                    error: "Timeout must be between 5 and 300 seconds"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/control/water/:
    post:
      tags:
        - Automation - Device Control
      summary: Execute water control command
      description: |
        Send a water control command to the pond device.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Available Commands:**
        - `WATER_DRAIN`: Drain water to specified level
        - `WATER_FILL`: Fill water to specified level
        - `WATER_FLUSH`: Flush water system
        - `WATER_INLET_OPEN/CLOSE`: Control inlet valve
        - `WATER_OUTLET_OPEN/CLOSE`: Control outlet valve
        
        **Command Details:**
        - Command is sent to the device via MQTT
        - Device acknowledges receipt and executes
        - Status is tracked until completion
        - Retry mechanism handles failures
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - command_type
              properties:
                command_type:
                  type: string
                  enum: [WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE]
                  description: Type of water control command
                  example: "WATER_DRAIN"
                drain_level:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 100
                  description: Water level to drain to (percentage, for WATER_DRAIN and WATER_FLUSH)
                  example: 0.0
                target_level:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 100
                  description: Target water level (percentage, for WATER_FILL and WATER_FLUSH)
                  example: 80.0
            examples:
              drain_water:
                summary: Drain water completely
                value:
                  command_type: "WATER_DRAIN"
                  drain_level: 0.0
              fill_water:
                summary: Fill water to target level
                value:
                  command_type: "WATER_FILL"
                  target_level: 80.0
              flush_system:
                summary: Flush water system
                value:
                  command_type: "WATER_FLUSH"
                  drain_level: 0.0
                  target_level: 80.0
      responses:
        '200':
          description: Water control command sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          command_id:
                            type: string
                            format: uuid
                            description: Unique command identifier
                            example: "550e8400-e29b-41d4-a716-446655440000"
                          message:
                            type: string
                            description: Success message
                            example: "WATER_DRAIN command sent successfully"
                          status:
                            type: string
                            enum: [PENDING, SENT, ACKNOWLEDGED, COMPLETED, FAILED, TIMEOUT]
                            description: Current command status
                            example: "SENT"
                          command_type:
                            type: string
                            description: Type of command sent
                            example: "WATER_DRAIN"
              examples:
                success:
                  summary: Successful command
                  value:
                    success: true
                    data:
                      command_id: "550e8400-e29b-41d4-a716-446655440000"
                      message: "WATER_DRAIN command sent successfully"
                      status: "SENT"
                      command_type: "WATER_DRAIN"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                missing_parameters:
                  summary: Missing required parameters
                  value:
                    success: false
                    error: "Missing required parameters for WATER_DRAIN command"
                invalid_level:
                  summary: Invalid water level
                  value:
                    success: false
                    error: "Water level must be between 0 and 100"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Device Control - Reboot Commands
  /automation/ponds/{pond_id}/control/reboot/:
    post:
      tags:
        - Automation - Device Control
      summary: Execute device reboot command
      description: |
        **üîÑ Send a reboot command to the pond device**
        
        This endpoint allows users to send a reboot command to restart the pond device.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this pond
        
        **Implementation:** Class-based APIView with IsAuthenticated permission
        
        **Command Details:**
        - Command is sent to the device via MQTT
        - Device acknowledges receipt and executes reboot
        - Status is tracked until completion
        - Device will restart and reconnect to MQTT broker
        
        **Use Cases:**
        - Device troubleshooting
        - System maintenance
        - Recovery from errors
        - Configuration refresh
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              description: No request body required for reboot command
            examples:
              simple_reboot:
                summary: Simple reboot command
                value: {}
      responses:
        '200':
          description: Reboot command sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          command_id:
                            type: string
                            format: uuid
                            description: Unique command identifier
                            example: "550e8400-e29b-41d4-a716-446655440000"
                          message:
                            type: string
                            description: Success message
                            example: "Reboot command sent successfully"
              examples:
                success:
                  summary: Successful reboot command
                  value:
                    success: true
                    data:
                      command_id: "550e8400-e29b-41d4-a716-446655440000"
                      message: "Reboot command sent successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Device Control - Threshold Commands
  /automation/ponds/{pond_id}/control/threshold/:
    post:
      tags:
        - Automation - Device Control
      summary: Execute threshold configuration command
      description: |
        Send a threshold configuration command to the pond device.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Command Details:**
        - Sets upper and lower thresholds for specified sensor parameter
        - Command is sent to the device via MQTT
        - Device acknowledges receipt and updates internal thresholds
        - Thresholds are stored in device memory for real-time monitoring
        - Database threshold record is created/updated automatically
        
        **Supported Sensor Parameters:**
        - `temperature`: Temperature thresholds (¬∞C)
        - `water_level`: Water level thresholds (percentage)
        - `feed_level`: Feed level thresholds (percentage)
        - `turbidity`: Turbidity thresholds (NTU)
        - `dissolved_oxygen`: Dissolved oxygen thresholds (mg/L)
        - `ph`: pH thresholds (pH units)
        - `ammonia`: Ammonia thresholds (mg/L)
        - `battery`: Battery level thresholds (percentage)
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - parameter
                - upper_threshold
                - lower_threshold
              properties:
                parameter:
                  type: string
                  enum: [temperature, water_level, feed_level, turbidity, dissolved_oxygen, ph, ammonia, battery]
                  description: Sensor parameter to configure thresholds for
                  example: "temperature"
                upper_threshold:
                  type: number
                  format: float
                  description: Upper threshold value
                  example: 30.0
                lower_threshold:
                  type: number
                  format: float
                  description: Lower threshold value
                  example: 20.0
            examples:
              temperature_threshold:
                summary: Set temperature thresholds
                value:
                  parameter: "temperature"
                  upper_threshold: 30.0
                  lower_threshold: 20.0
              water_level_threshold:
                summary: Set water level thresholds
                value:
                  parameter: "water_level"
                  upper_threshold: 95.0
                  lower_threshold: 20.0
              ph_threshold:
                summary: Set pH thresholds
                value:
                  parameter: "ph"
                  upper_threshold: 8.5
                  lower_threshold: 6.5
      responses:
        '200':
          description: Threshold configuration command sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      command_id:
                        type: string
                        format: uuid
                        description: Unique command identifier
                        example: "550e8400-e29b-41d4-a716-446655440000"
                      threshold_id:
                        type: integer
                        description: Database threshold record ID
                        example: 1
                      message:
                        type: string
                        description: Success message
                        example: "Threshold created and command sent successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                missing_parameter:
                  summary: Missing parameter field
                  value:
                    success: false
                    error: "Missing required field: parameter"
                invalid_thresholds:
                  summary: Invalid threshold values
                  value:
                    success: false
                    error: "lower_threshold must be less than upper_threshold"
                invalid_parameter:
                  summary: Invalid parameter name
                  value:
                    success: false
                    error: "parameter must be one of: temperature, water_level, feed_level, turbidity, dissolved_oxygen, ph, ammonia, battery"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Automation Monitoring & Status
  /automation/ponds/{pond_id}/status/:
    get:
      tags:
        - Automation - Monitoring
      summary: Get automation status for a pond
      description: |
        Retrieve the current automation status for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Response includes:**
        - Current automation status
        - Active schedules and their next execution times
        - Pending and executing automations
        - Recent automation history
        - Device connection status
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Successfully retrieved automation status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pond_id:
                            type: integer
                            description: Pond identifier
                            example: 1
                          automation_status:
                            type: string
                            enum: [IDLE, EXECUTING, SCHEDULED, ERROR, MAINTENANCE]
                            description: Current automation status
                            example: "IDLE"
                          active_schedules:
                            type: array
                            items:
                              $ref: '#/components/schemas/AutomationSchedule'
                            description: Active automation schedules
                          pending_executions:
                            type: array
                            items:
                              $ref: '#/components/schemas/AutomationExecution'
                            description: Pending automation executions
                          executing_automations:
                            type: array
                            items:
                              $ref: '#/components/schemas/AutomationExecution'
                            description: Currently executing automations
                          device_status:
                            type: string
                            enum: [ONLINE, OFFLINE, ERROR, MAINTENANCE]
                            description: Device connection status
                            example: "ONLINE"
                          last_automation:
                            type: object
                            properties:
                              type:
                                type: string
                                description: Type of last automation
                                example: "FEED"
                              timestamp:
                                type: string
                                format: date-time
                                description: When last automation occurred
                                example: "2024-01-15T10:00:00Z"
                              status:
                                type: string
                                description: Status of last automation
                                example: "COMPLETED"
                          next_scheduled:
                            type: string
                            format: date-time
                            description: Next scheduled automation
                            example: "2024-01-16T10:00:00Z"
              examples:
                success:
                  summary: Successful status retrieval
                  value:
                    success: true
                    data:
                      pond_id: 1
                      automation_status: "IDLE"
                      active_schedules:
                        - id: 1
                          automation_type: "FEED"
                          is_active: true
                          time: "10:00:00"
                          next_execution: "2024-01-16T10:00:00Z"
                      pending_executions: []
                      executing_automations: []
                      device_status: "ONLINE"
                      last_automation:
                        type: "FEED"
                        timestamp: "2024-01-15T10:00:00Z"
                        status: "COMPLETED"
                      next_scheduled: "2024-01-16T10:00:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/history/:
    get:
      tags:
        - Automation - History
      summary: Get automation history for a pond
      description: |
        Retrieve automation execution history for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Response includes:**
        - Automation execution history
        - Device command history
        - Success/failure rates
        - Performance metrics
        
        **Filtering Options:**
        - By date range
        - By automation type
        - By execution status
        - By priority level
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: start_date
          in: query
          required: false
          description: Start date for history (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-01"
        - name: end_date
          in: query
          required: false
          description: End date for history (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-15"
        - name: execution_type
          in: query
          required: false
          description: Filter by automation type
          schema:
            type: string
            enum: [FEED, WATER]
            example: "FEED"
        - name: status
          in: query
          required: false
          description: Filter by execution status
          schema:
            type: string
            enum: [PENDING, EXECUTING, COMPLETED, FAILED, CANCELLED]
            example: "COMPLETED"
        - name: priority
          in: query
          required: false
          description: Filter by priority level
          schema:
            type: string
            enum: [MANUAL_COMMAND, EMERGENCY_WATER, SCHEDULED, THRESHOLD]
            example: "SCHEDULED"
        - name: page
          in: query
          required: false
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: page_size
          in: query
          required: false
          description: Number of items per page (max 200)
          schema:
            type: integer
            minimum: 1
            maximum: 200
            example: 50
      responses:
        '200':
          description: Successfully retrieved automation history
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/AutomationExecution'
                        description: List of automation executions
                      count:
                        type: integer
                        description: Total number of executions
                        example: 150
                      summary:
                        type: object
                        properties:
                          total_executions:
                            type: integer
                            description: Total executions in date range
                            example: 150
                          successful:
                            type: integer
                            description: Successful executions
                            example: 145
                          failed:
                            type: integer
                            description: Failed executions
                            example: 5
                          success_rate:
                            type: number
                            format: float
                            description: Success rate percentage
                            example: 96.67
                          avg_execution_time:
                            type: number
                            format: float
                            description: Average execution time in seconds
                            example: 45.2
                      next:
                        type: string
                        description: URL for next page
                        example: "http://localhost:8000/automation/ponds/1/history/?page=2"
                      previous:
                        type: string
                        description: URL for previous page
                        example: null
              examples:
                success:
                  summary: Successful history retrieval
                  value:
                    success: true
                    data:
                      - id: 1
                        pond: 1
                        execution_type: "FEED"
                        action: "FEED"
                        priority: "SCHEDULED"
                        status: "COMPLETED"
                        scheduled_at: "2024-01-15T10:00:00Z"
                        started_at: "2024-01-15T10:00:00Z"
                        completed_at: "2024-01-15T10:00:45Z"
                        parameters:
                          feed_amount: 100
                        success: true
                        result_message: "Feed dispensed successfully"
                    count: 1
                    summary:
                      total_executions: 150
                      successful: 145
                      failed: 5
                      success_rate: 96.67
                      avg_execution_time: 45.2
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /automation/ponds/{pond_id}/history/commands/:
    get:
      tags:
        - Automation - History
      summary: Get device command history for a pond
      description: |
        Retrieve device command history for a specific pond.
        
        **Permissions Required:** User must own the pond pair containing this pond.
        
        **Response includes:**
        - Device command history
        - Command execution status
        - Success/failure rates
        - Response times and retry information
        
        **Filtering Options:**
        - By date range
        - By command type
        - By command status
        - By success/failure
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
        - name: start_date
          in: query
          required: false
          description: Start date for history (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-01"
        - name: end_date
          in: query
          required: false
          description: End date for history (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-15"
        - name: command_type
          in: query
          required: false
          description: Filter by command type
          schema:
            type: string
            enum: [FEED, WATER_DRAIN, WATER_FILL, WATER_FLUSH, WATER_INLET_OPEN, WATER_INLET_CLOSE, WATER_OUTLET_OPEN, WATER_OUTLET_CLOSE, FIRMWARE_UPDATE, RESTART, CONFIG_UPDATE]
            example: "FEED"
        - name: status
          in: query
          required: false
          description: Filter by command status
          schema:
            type: string
            enum: [PENDING, SENT, ACKNOWLEDGED, COMPLETED, FAILED, TIMEOUT]
            example: "COMPLETED"
        - name: success
          in: query
          required: false
          description: Filter by success status
          schema:
            type: boolean
            example: true
        - name: page
          in: query
          required: false
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: page_size
          in: query
          required: false
          description: Number of items per page (max 200)
          schema:
            type: integer
            minimum: 1
            maximum: 200
            example: 50
      responses:
        '200':
          description: Successfully retrieved command history
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/DeviceCommand'
                        description: List of device commands
                      count:
                        type: integer
                        description: Total number of commands
                        example: 75
                      summary:
                        type: object
                        properties:
                          total_commands:
                            type: integer
                            description: Total commands in date range
                            example: 75
                          successful:
                            type: integer
                            description: Successful commands
                            example: 72
                          failed:
                            type: integer
                            description: Failed commands
                            example: 3
                          success_rate:
                            type: number
                            format: float
                            description: Success rate percentage
                            example: 96.0
                          avg_response_time:
                            type: number
                            format: float
                            description: Average response time in seconds
                            example: 12.5
                          avg_retry_count:
                            type: number
                            format: float
                            description: Average retry attempts
                            example: 0.2
                      next:
                        type: string
                        description: URL for next page
                        example: "http://localhost:8000/automation/ponds/1/history/commands/?page=2"
                      previous:
                        type: string
                        description: URL for previous page
                        example: null
              examples:
                success:
                  summary: Successful command history retrieval
                  value:
                    success: true
                    data:
                      - id: 1
                        pond: 1
                        command_type: "FEED"
                        status: "COMPLETED"
                        command_id: "550e8400-e29b-41d4-a716-446655440000"
                        parameters:
                          feed_amount: 100
                        sent_at: "2024-01-15T10:00:00Z"
                        acknowledged_at: "2024-01-15T10:00:05Z"
                        completed_at: "2024-01-15T10:00:15Z"
                        success: true
                        result_message: "Feed dispensed successfully"
                    count: 1
                    summary:
                      total_commands: 75
                      successful: 72
                      failed: 3
                      success_rate: 96.0
                      avg_response_time: 12.5
                      avg_retry_count: 0.2
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # System Monitoring
  /automation/pending/:
    get:
      tags:
        - Automation - Monitoring
      summary: Get pending automations across all ponds
      description: |
        Retrieve all pending automation executions across all ponds accessible to the user.
        
        **Permissions Required:** User must be authenticated.
        
        **Response includes:**
        - Pending automation executions
        - Scheduled automations
        - Threshold violations awaiting action
        - Priority-based ordering
        
        **Use Cases:**
        - Dashboard overview
        - System monitoring
        - Manual intervention planning
      parameters:
        - name: priority
          in: query
          required: false
          description: Filter by priority level
          schema:
            type: string
            enum: [MANUAL_COMMAND, EMERGENCY_WATER, SCHEDULED, THRESHOLD]
            example: "EMERGENCY_WATER"
        - name: execution_type
          in: query
          required: false
          description: Filter by automation type
          schema:
            type: string
            enum: [FEED, WATER]
            example: "WATER"
        - name: page
          in: query
          required: false
          description: Page number for pagination
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: page_size
          in: query
          required: false
          description: Number of items per page (max 200)
          schema:
            type: integer
            minimum: 1
            maximum: 200
            example: 50
      responses:
        '200':
          description: Successfully retrieved pending automations
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/AutomationExecution'
                        description: List of pending automations
                      count:
                        type: integer
                        description: Total number of pending automations
                        example: 12
                      summary:
                        type: object
                        properties:
                          total_pending:
                            type: integer
                            description: Total pending automations
                            example: 12
                          by_priority:
                            type: object
                            properties:
                              MANUAL_COMMAND:
                                type: integer
                                description: Manual command count
                                example: 2
                              EMERGENCY_WATER:
                                type: integer
                                description: Emergency water count
                                example: 1
                              SCHEDULED:
                                type: integer
                                description: Scheduled count
                                example: 8
                              THRESHOLD:
                                type: integer
                                description: Threshold count
                                example: 1
                          by_type:
                            type: object
                            properties:
                              FEED:
                                type: integer
                                description: Feed automation count
                                example: 8
                              WATER:
                                type: integer
                                description: Water automation count
                                example: 4
              examples:
                success:
                  summary: Successful retrieval
                  value:
                    success: true
                    data:
                      - id: 1
                        pond: 1
                        execution_type: "FEED"
                        action: "FEED"
                        priority: "SCHEDULED"
                        status: "PENDING"
                        scheduled_at: "2024-01-16T10:00:00Z"
                        parameters:
                          feed_amount: 100
                    count: 1
                    summary:
                      total_pending: 12
                      by_priority:
                        MANUAL_COMMAND: 2
                        EMERGENCY_WATER: 1
                        SCHEDULED: 8
                        THRESHOLD: 1
                      by_type:
                        FEED: 8
                        WATER: 4
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Automation Conflicts Resolution
  /automation/ponds/{pond_id}/conflicts/resolve/:
    post:
      tags:
        - Automation - Conflict Resolution
      summary: Resolve automation conflicts
      description: |
        **üîß Resolve conflicts between automation schedules and thresholds**
        
        This endpoint allows users to resolve conflicts between different automation
        rules and schedules for a specific pond.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this pond
        
        **Use Cases:**
        - Resolve scheduling conflicts
        - Prioritize automation rules
        - Override conflicting thresholds
        - Manual conflict resolution
        
        **Response includes:**
        - Conflict resolution status
        - Updated automation priorities
        - Resolution confirmation
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - conflict_type
                - resolution_action
              properties:
                conflict_type:
                  type: string
                  enum: [SCHEDULE_OVERRIDE, THRESHOLD_OVERRIDE, PRIORITY_CONFLICT, TIMING_CONFLICT]
                  description: Type of conflict to resolve
                  example: "SCHEDULE_OVERRIDE"
                resolution_action:
                  type: string
                  enum: [OVERRIDE, RESCHEDULE, DISABLE, PRIORITIZE]
                  description: Action to take to resolve the conflict
                  example: "OVERRIDE"
                parameters:
                  type: object
                  description: Resolution-specific parameters
                  example: {"new_priority": 1, "delay_minutes": 30}
            examples:
              schedule_override:
                summary: Override conflicting schedule
                value:
                  conflict_type: "SCHEDULE_OVERRIDE"
                  resolution_action: "OVERRIDE"
                  parameters: {"delay_minutes": 30}
              priority_resolution:
                summary: Resolve priority conflict
                value:
                  conflict_type: "PRIORITY_CONFLICT"
                  resolution_action: "PRIORITIZE"
                  parameters: {"new_priority": 1}
      responses:
        '200':
          description: Conflict resolved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          conflict_id:
                            type: integer
                            description: ID of the resolved conflict
                            example: 1
                          resolution_status:
                            type: string
                            enum: [RESOLVED, PARTIALLY_RESOLVED, PENDING]
                            description: Status of conflict resolution
                            example: "RESOLVED"
                          message:
                            type: string
                            description: Resolution confirmation message
                            example: "Schedule conflict resolved successfully"
                          updated_automations:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  description: Automation ID
                                  example: 1
                                type:
                                  type: string
                                  description: Automation type
                                  example: "FEED"
                                new_priority:
                                  type: integer
                                  description: Updated priority
                                  example: 1
              examples:
                success:
                  summary: Successful conflict resolution
                  value:
                    success: true
                    data:
                      conflict_id: 1
                      resolution_status: "RESOLVED"
                      message: "Schedule conflict resolved successfully"
                      updated_automations:
                        - id: 1
                          type: "FEED"
                          new_priority: 1
        '400':
          description: Bad request - invalid conflict resolution parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Firmware Command Execution
  /automation/ponds/{pond_id}/control/firmware/:
    post:
      tags:
        - Automation - Device Control
      summary: Execute firmware command
      description: |
        **üîß Send firmware-related commands to the pond device**
        
        This endpoint allows users to send firmware update, restart, and configuration
        commands to the pond device.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this pond
        
        **Implementation:** Class-based APIView with IsAuthenticated permission
        
        **Available Commands:**
        - `FIRMWARE_UPDATE`: Update device firmware
        - `RESTART`: Restart the device
        - `CONFIG_UPDATE`: Update device configuration
        
        **Use Cases:**
        - Device maintenance
        - Firmware updates
        - System troubleshooting
        - Configuration management
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - command_type
              properties:
                command_type:
                  type: string
                  enum: [FIRMWARE_UPDATE, RESTART, CONFIG_UPDATE]
                  description: Type of firmware command to execute
                  example: "RESTART"
                parameters:
                  type: object
                  description: Command-specific parameters
                  properties:
                    firmware_url:
                      type: string
                      description: Firmware download URL (for FIRMWARE_UPDATE)
                      example: "https://example.com/firmware.bin"
                    config_data:
                      type: object
                      description: Configuration data (for CONFIG_UPDATE)
                      example: {"timeout": 300, "retry_count": 3}
                  example: {"firmware_url": "https://example.com/firmware.bin"}
            examples:
              firmware_update:
                summary: Update firmware
                value:
                  command_type: "FIRMWARE_UPDATE"
                  parameters: {"firmware_url": "https://example.com/firmware.bin"}
              config_update:
                summary: Update device configuration
                value:
                  command_type: "CONFIG_UPDATE"
                  parameters: {"config_data": {"timeout": 300, "retry_count": 3}}
      responses:
        '200':
          description: Firmware command sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          command_id:
                            type: string
                            format: uuid
                            description: Unique command identifier
                            example: "550e8400-e29b-41d4-a716-446655440000"
                          message:
                            type: string
                            description: Success message
                            example: "Firmware command sent successfully"
                          status:
                            type: string
                            enum: [PENDING, SENT, ACKNOWLEDGED, COMPLETED, FAILED, TIMEOUT]
                            description: Current command status
                            example: "SENT"
                          command_type:
                            type: string
                            description: Type of command sent
                            example: "RESTART"
              examples:
                success:
                  summary: Successful command
                  value:
                    success: true
                    data:
                      command_id: "550e8400-e29b-41d4-a716-446655440000"
                      message: "Firmware command sent successfully"
                      status: "SENT"
                      command_type: "RESTART"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Alert Management
  /automation/alerts/{alert_id}/acknowledge/:
    post:
      tags:
        - Automation - Alert Management
      summary: Acknowledge an alert
      description: |
        **üîî Acknowledge an automation alert**
        
        This endpoint allows users to acknowledge alerts, indicating they are aware
        of the issue and taking action.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this alert
        
        **Use Cases:**
        - Alert acknowledgment
        - Issue tracking
        - Alert status management
        - Workflow coordination
        
        **Response includes:**
        - Alert acknowledgment status
        - Updated alert information
        - Acknowledgment timestamp
      security:
        - BearerAuth: []
      parameters:
        - name: alert_id
          in: path
          required: true
          description: Unique identifier of the alert
          schema:
            type: integer
            example: 1
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                acknowledgment_note:
                  type: string
                  maxLength: 500
                  description: Optional note about the acknowledgment
                  example: "Investigating the issue"
                priority:
                  type: string
                  enum: [LOW, MEDIUM, HIGH, CRITICAL]
                  description: Updated priority level
                  example: "MEDIUM"
            examples:
              with_note:
                summary: Acknowledge with note
                value:
                  acknowledgment_note: "Investigating the issue"
                  priority: "MEDIUM"
              simple_ack:
                summary: Simple acknowledgment
                value: {}
      responses:
        '200':
          description: Alert acknowledged successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          alert_id:
                            type: integer
                            description: Alert ID
                            example: 1
                          status:
                            type: string
                            enum: [ACKNOWLEDGED, RESOLVED, PENDING]
                            description: Updated alert status
                            example: "ACKNOWLEDGED"
                          acknowledged_at:
                            type: string
                            format: date-time
                            description: When alert was acknowledged
                            example: "2024-01-15T14:30:00Z"
                          acknowledged_by:
                            type: integer
                            description: User ID who acknowledged
                            example: 1
                          message:
                            type: string
                            description: Success message
                            example: "Alert acknowledged successfully"
              examples:
                success:
                  summary: Successful acknowledgment
                  value:
                    success: true
                    data:
                      alert_id: 1
                      status: "ACKNOWLEDGED"
                      acknowledged_at: "2024-01-15T14:30:00Z"
                      acknowledged_by: 1
                      message: "Alert acknowledged successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Alert not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /automation/alerts/{alert_id}/resolve/:
    post:
      tags:
        - Automation - Alert Management
      summary: Resolve an alert
      description: |
        **‚úÖ Resolve an automation alert**
        
        This endpoint allows users to mark alerts as resolved, indicating the issue
        has been fixed or addressed.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this alert
        
        **Use Cases:**
        - Alert resolution
        - Issue tracking closure
        - Workflow completion
        - Performance monitoring
        
        **Response includes:**
        - Alert resolution status
        - Resolution details
        - Resolution timestamp
      security:
        - BearerAuth: []
      parameters:
        - name: alert_id
          in: path
          required: true
          description: Unique identifier of the alert
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - resolution_method
              properties:
                resolution_method:
                  type: string
                  enum: [AUTOMATIC, MANUAL, SCHEDULED, THRESHOLD_ADJUSTMENT]
                  description: How the alert was resolved
                  example: "MANUAL"
                resolution_note:
                  type: string
                  maxLength: 1000
                  description: Details about how the issue was resolved
                  example: "Adjusted temperature threshold and restarted system"
                follow_up_required:
                  type: boolean
                  description: Whether follow-up action is needed
                  example: false
            examples:
              manual_resolution:
                summary: Manual resolution
                value:
                  resolution_method: "MANUAL"
                  resolution_note: "Adjusted temperature threshold and restarted system"
                  follow_up_required: false
              automatic_resolution:
                summary: Automatic resolution
                value:
                  resolution_method: "AUTOMATIC"
                  resolution_note: "System automatically adjusted parameters"
                  follow_up_required: true
      responses:
        '200':
          description: Alert resolved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          alert_id:
                            type: integer
                            description: Alert ID
                            example: 1
                          status:
                            type: string
                            enum: [ACKNOWLEDGED, RESOLVED, PENDING]
                            description: Updated alert status
                            example: "RESOLVED"
                          resolved_at:
                            type: string
                            format: date-time
                            description: When alert was resolved
                            example: "2024-01-15T15:00:00Z"
                          resolved_by:
                            type: integer
                            description: User ID who resolved
                            example: 1
                          resolution_method:
                            type: string
                            description: How alert was resolved
                            example: "MANUAL"
                          message:
                            type: string
                            description: Success message
                            example: "Alert resolved successfully"
              examples:
                success:
                  summary: Successful resolution
                  value:
                    success: true
                    data:
                      alert_id: 1
                      status: "RESOLVED"
                      resolved_at: "2024-01-15T15:00:00Z"
                      resolved_by: 1
                      resolution_method: "MANUAL"
                      message: "Alert resolved successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Alert not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Threshold Configuration
  /automation/ponds/{pond_id}/thresholds/config/:
    get:
      tags:
        - Automation - Threshold Configuration
      summary: Get threshold configuration for a pond
      description: |
        **‚öôÔ∏è Retrieve comprehensive threshold configuration for a pond**
        
        This endpoint provides detailed threshold configuration including active
        thresholds, their relationships, and configuration options.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this pond
        
        **Use Cases:**
        - Threshold management interface
        - Configuration review
        - System optimization
        - Troubleshooting
        
        **Response includes:**
        - Active threshold configurations
        - Threshold relationships and dependencies
        - Configuration options and constraints
        - System recommendations
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Threshold configuration retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pond_id:
                            type: integer
                            description: Pond ID
                            example: 1
                          active_thresholds:
                            type: array
                            items:
                              $ref: '#/components/schemas/SensorThreshold'
                            description: List of active thresholds
                          threshold_groups:
                            type: array
                            items:
                              type: object
                              properties:
                                group_name:
                                  type: string
                                  description: Group name
                                  example: "Water Quality"
                                thresholds:
                                  type: array
                                  items:
                                    type: integer
                                  description: Threshold IDs in this group
                                  example: [1, 2, 3]
                                priority:
                                  type: integer
                                  description: Group priority
                                  example: 1
                            description: Threshold grouping information
                          configuration_options:
                            type: object
                            properties:
                              max_thresholds_per_parameter:
                                type: integer
                                description: Maximum thresholds per sensor parameter
                                example: 3
                              priority_levels:
                                type: array
                                items:
                                  type: integer
                                description: Available priority levels
                                example: [1, 2, 3, 4, 5]
                              automation_actions:
                                type: array
                                items:
                                  type: string
                                description: Available automation actions
                                example: ["ALERT", "FEED", "WATER_DRAIN"]
              examples:
                success:
                  summary: Successful configuration retrieval
                  value:
                    success: true
                    data:
                      pond_id: 1
                      active_thresholds:
                        - id: 1
                          parameter: "temperature"
                          upper_threshold: 30.0
                          lower_threshold: 20.0
                          automation_action: "ALERT"
                          priority: 2
                      threshold_groups:
                        - group_name: "Water Quality"
                          thresholds: [1, 2, 3]
                          priority: 1
                      configuration_options:
                        max_thresholds_per_parameter: 3
                        priority_levels: [1, 2, 3, 4, 5]
                        automation_actions: ["ALERT", "FEED", "WATER_DRAIN"]
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Device Status
  /automation/ponds/{pond_id}/device/status/:
    get:
      tags:
        - Automation - Device Status
      summary: Get device status for a pond
      description: |
        **üì± Retrieve comprehensive device status and health information**
        
        This endpoint provides detailed device status including connectivity,
        health metrics, and operational status for the pond's automation device.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing this pond
        
        **Use Cases:**
        - Device monitoring
        - System health checks
        - Troubleshooting
        - Performance monitoring
        - Maintenance planning
        
        **Response includes:**
        - Device connectivity status
        - System health metrics
        - Operational statistics
        - Error logs and diagnostics
        - Maintenance recommendations
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Unique identifier of the pond
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Device status retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          device_id:
                            type: string
                            description: Device MAC address
                            example: "AA:BB:CC:DD:EE:FF"
                          connectivity_status:
                            type: string
                            enum: [ONLINE, OFFLINE, CONNECTING, ERROR]
                            description: Current connectivity status
                            example: "ONLINE"
                          last_seen:
                            type: string
                            format: date-time
                            description: Last communication timestamp
                            example: "2024-01-15T14:30:00Z"
                          system_health:
                            type: object
                            properties:
                              cpu_usage:
                                type: number
                                format: float
                                description: CPU usage percentage
                                example: 45.2
                              memory_usage:
                                type: number
                                format: float
                                description: Memory usage percentage
                                example: 67.8
                              disk_usage:
                                type: number
                                format: float
                                description: Disk usage percentage
                                example: 23.1
                              temperature:
                                type: number
                                format: float
                                description: Device temperature in Celsius
                                example: 42.5
                            description: System health metrics
                          operational_stats:
                            type: object
                            properties:
                              uptime_hours:
                                type: number
                                format: float
                                description: Device uptime in hours
                                example: 168.5
                              commands_processed:
                                type: integer
                                description: Total commands processed
                                example: 1250
                              commands_failed:
                                type: integer
                                description: Failed commands count
                                example: 12
                              last_error:
                                type: string
                                description: Last error message
                                example: "Connection timeout"
                            description: Operational statistics
                          maintenance_info:
                            type: object
                            properties:
                              last_maintenance:
                                type: string
                                format: date-time
                                description: Last maintenance timestamp
                                example: "2024-01-01T10:00:00Z"
                              next_maintenance:
                                type: string
                                format: date-time
                                description: Next scheduled maintenance
                                example: "2024-02-01T10:00:00Z"
                              maintenance_required:
                                type: boolean
                                description: Whether maintenance is required
                                example: false
                              recommendations:
                                type: array
                                items:
                                  type: string
                                description: Maintenance recommendations
                                example: ["Check sensor calibration", "Update firmware"]
                            description: Maintenance information
              examples:
                success:
                  summary: Successful status retrieval
                  value:
                    success: true
                    data:
                      device_id: "AA:BB:CC:DD:EE:FF"
                      connectivity_status: "ONLINE"
                      last_seen: "2024-01-15T14:30:00Z"
                      system_health:
                        cpu_usage: 45.2
                        memory_usage: 67.8
                        disk_usage: 23.1
                        temperature: 42.5
                      operational_stats:
                        uptime_hours: 168.5
                        commands_processed: 1250
                        commands_failed: 12
                        last_error: "Connection timeout"
                      maintenance_info:
                        last_maintenance: "2024-01-01T10:00:00Z"
                        next_maintenance: "2024-02-01T10:00:00Z"
                        maintenance_required: false
                        recommendations: ["Check sensor calibration", "Update firmware"]
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # Feed Event Logging
  /automation/feed/log-event/:
    post:
      tags:
        - Automation - Feed Events
      summary: Log a feed event
      description: |
        **üçΩÔ∏è Log a manual or automated feed event**
        
        This endpoint allows users to log feed events for tracking and analysis.
        Can be used for both manual feeding and automated feeding events.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond pair containing the specified pond
        
        **Use Cases:**
        - Manual feed logging
        - Automated feed tracking
        - Feed consumption analysis
        - Performance monitoring
        - Historical record keeping
        
        **Response includes:**
        - Feed event confirmation
        - Event details and timestamp
        - Updated feed statistics
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - pond_id
                - amount
              properties:
                pond_id:
                  type: integer
                  description: ID of the pond where feeding occurred
                  example: 1
                amount:
                  type: number
                  format: float
                  minimum: 0.01
                  maximum: 100.0
                  description: Feed amount in kilograms
                  example: 0.5
                feed_type:
                  type: string
                  enum: [MANUAL, AUTOMATED, SCHEDULED, THRESHOLD_TRIGGERED]
                  description: Type of feed event
                  example: "MANUAL"
                notes:
                  type: string
                  maxLength: 500
                  description: Optional notes about the feeding
                  example: "Extra feeding due to high activity"
            examples:
              manual_feed:
                summary: Manual feeding event
                value:
                  pond_id: 1
                  amount: 0.5
                  feed_type: "MANUAL"
                  notes: "Extra feeding due to high activity"
              automated_feed:
                summary: Automated feeding event
                value:
                  pond_id: 1
                  amount: 0.3
                  feed_type: "AUTOMATED"
      responses:
        '201':
          description: Feed event logged successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          event_id:
                            type: integer
                            description: Feed event ID
                            example: 1
                          pond_id:
                            type: integer
                            description: Pond ID
                            example: 1
                          amount:
                            type: number
                            format: float
                            description: Feed amount in kilograms
                            example: 0.5
                          feed_type:
                            type: string
                            description: Type of feed event
                            example: "MANUAL"
                          timestamp:
                            type: string
                            format: date-time
                            description: When feeding occurred
                            example: "2024-01-15T14:30:00Z"
                          user:
                            type: integer
                            description: User ID who logged the event
                            example: 1
                          message:
                            type: string
                            description: Success message
                            example: "Feed event logged successfully"
              examples:
                success:
                  summary: Successful feed event logging
                  value:
                    success: true
                    data:
                      event_id: 1
                      pond_id: 1
                      amount: 0.5
                      feed_type: "MANUAL"
                      timestamp: "2024-01-15T14:30:00Z"
                      user: 1
                      message: "Feed event logged successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # =============================================================================
  # AUTOMATION SECTION COMPLETE
  # =============================================================================
  
  # =============================================================================
  # PONDS APP ENDPOINTS
  # =============================================================================
  
  # Pond Pair Management
  /ponds/:
    get:
      tags:
        - Ponds
      summary: Get all pond pairs
      description: |
        **üêü Retrieve all pond pairs for the authenticated user**
        
        This endpoint returns a list of pond pairs with comprehensive pond information.
        Each pond pair can contain up to 2 ponds and is associated with a device.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access pond pairs they own
        
        **Response includes:**
        - Pond pair basic information (name, device_id, owner)
        - Pond count and completion status
        - Detailed pond information including controls and latest sensor data
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Pond pairs retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Pond pair ID
                      example: 1
                    name:
                      type: string
                      description: Pond pair name
                      example: "Main Production Pair"
                    device_id:
                      type: string
                      description: Device MAC address
                      example: "AA:BB:CC:DD:EE:FF"
                    owner:
                      type: integer
                      description: Owner user ID
                      example: 1
                    owner_username:
                      type: string
                      description: Owner username
                      example: "user@example.com"
                    created_at:
                      type: string
                      format: date-time
                      description: Creation timestamp
                      example: "2024-01-15T10:30:00Z"
                    ponds:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: integer
                            description: Pond ID
                            example: 1
                          name:
                            type: string
                            description: Pond name
                            example: "Pond 1"
                          is_active:
                            type: boolean
                            description: Whether pond is active
                            example: true
                          created_at:
                            type: string
                            format: date-time
                            description: Pond creation timestamp
                            example: "2024-01-15T10:30:00Z"
                          control:
                            type: object
                            nullable: true
                            description: Pond control information
                            properties:
                              water_valve_state:
                                type: boolean
                                description: Whether water valve is open (true) or closed (false)
                                example: true
                              last_feed_time:
                                type: string
                                format: date-time
                                description: Timestamp of last feed operation
                                example: "2024-01-15T10:00:00Z"
                              last_feed_amount:
                                type: number
                                format: float
                                description: Amount of feed dispensed in grams
                                example: 150.0
                          latest_sensor_data:
                            type: object
                            nullable: true
                            description: Latest non-zero sensor readings
                            properties:
                              timestamp:
                                type: string
                                format: date-time
                                description: Timestamp of the sensor reading
                                example: "2024-01-15T10:00:00Z"
                              temperature:
                                type: number
                                format: float
                                description: Water temperature in Celsius
                                example: 25.5
                              water_level:
                                type: number
                                format: float
                                description: Water level percentage
                                example: 85.0
                              feed_level:
                                type: number
                                format: float
                                description: Feed level percentage
                                example: 50.0
                              turbidity:
                                type: number
                                format: float
                                description: Water turbidity in NTU
                                example: 15.0
                              dissolved_oxygen:
                                type: number
                                format: float
                                description: Dissolved oxygen in mg/L
                                example: 8.5
                              ph:
                                type: number
                                format: float
                                description: Water pH level
                                example: 7.2
                              ammonia:
                                type: number
                                format: float
                                description: Ammonia level in mg/L
                                example: 2.5
                              battery:
                                type: number
                                format: float
                                description: Device battery level percentage
                                example: 90.0
                              device_timestamp:
                                type: string
                                format: date-time
                                nullable: true
                                description: Timestamp from the device
                                example: "2024-01-15T10:00:00Z"
                              signal_strength:
                                type: integer
                                nullable: true
                                description: WiFi signal strength in dBm
                                example: -45
                    pond_count:
                      type: integer
                      description: Number of ponds in the pair
                      example: 2
                    is_complete:
                      type: boolean
                      description: Whether pair has exactly 2 ponds
                      example: true
              examples:
                success:
                  summary: Successful pond pairs retrieval
                  value:
                    - id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                      owner: 1
                      owner_username: "user@example.com"
                      created_at: "2024-01-15T10:30:00Z"
                      ponds:
                        - id: 1
                          name: "Pond 1"
                          is_active: true
                          created_at: "2024-01-15T10:30:00Z"
                          control:
                            water_valve_state: true
                            last_feed_time: "2024-01-15T10:00:00Z"
                            last_feed_amount: 150.0
                          latest_sensor_data:
                            timestamp: "2024-01-15T10:00:00Z"
                            temperature: 25.5
                            water_level: 85.0
                            feed_level: 50.0
                            turbidity: 15.0
                            dissolved_oxygen: 8.5
                            ph: 7.2
                            ammonia: 2.5
                            battery: 90.0
                            device_timestamp: "2024-01-15T10:00:00Z"
                            signal_strength: -45
                        - id: 2
                          name: "Pond 2"
                          is_active: true
                          created_at: "2024-01-15T10:30:00Z"
                          control:
                            water_valve_state: false
                            last_feed_time: "2024-01-15T09:30:00Z"
                            last_feed_amount: 120.0
                          latest_sensor_data:
                            timestamp: "2024-01-15T10:00:00Z"
                            temperature: 24.8
                            water_level: 78.0
                            feed_level: 65.0
                            turbidity: 12.0
                            dissolved_oxygen: 7.8
                            ph: 6.9
                            ammonia: 1.8
                            battery: 85.0
                            device_timestamp: "2024-01-15T10:00:00Z"
                            signal_strength: -42
                      pond_count: 2
                      is_complete: true
                      battery_level: 90.0
                      device_status:
                        status: "ONLINE"
                        last_seen: "2024-01-15T10:00:00Z"
                        is_online: true
                        firmware_version: "1.2.3"
                        hardware_version: "ESP32-V1"
                        device_name: "Test Device"
                        ip_address: "192.168.1.100"
                        wifi_ssid: "TestWiFi"
                        wifi_signal_strength: -45
                        free_heap: 100000
                        cpu_frequency: 240
                        error_count: 0
                        last_error: null
                        last_error_at: null
                        uptime_percentage_24h: 95.5
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  /ponds/summary/:
    get:
      tags:
        - Ponds
      summary: Get pond pair summaries
      description: |
        **üìã Retrieve lightweight summary of all pond pairs**
        
        This endpoint returns a summary list of pond pairs with minimal information
        for quick overview and navigation.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access pond pairs they own
        
        **Response includes:**
        - Basic pond pair information (name, device_id, pond_count)
        - Completion status indicators
        - Creation timestamps
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Pond pair summaries retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Pond pair ID
                      example: 1
                    name:
                      type: string
                      description: Pond pair name
                      example: "Main Production Pair"
                    device_id:
                      type: string
                      description: Device MAC address
                      example: "AA:BB:CC:DD:EE:FF"
                    pond_count:
                      type: integer
                      description: Number of ponds in the pair
                      example: 2
                    is_complete:
                      type: boolean
                      description: Whether pair has exactly 2 ponds
                      example: true
                    created_at:
                      type: string
                      format: date-time
                      description: Creation timestamp
                      example: "2024-01-15T10:30:00Z"
              examples:
                success:
                  summary: Successful summaries retrieval
                  value:
                    - id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                      pond_count: 2
                      is_complete: true
                      created_at: "2024-01-15T10:30:00Z"
                    - id: 2
                      name: "Secondary Pair"
                      device_id: "11:22:33:44:55:66"
                      pond_count: 1
                      is_complete: false
                      created_at: "2024-01-20T14:20:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
    
    post:
      tags:
        - Ponds
      summary: Create a new pond pair
      description: |
        **üêü Create a new pond pair with initial ponds**
        
        This endpoint allows authenticated users to create new pond pairs.
        Each pond pair can contain 1-2 ponds and is associated with a device.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must have pond creation privileges
        
        **Required Fields:** name, device_id
        **Optional Fields:** pond_names (1-2 pond names)
        
        **Note:** If device_id already exists and is owned by system user,
        this will reactivate the existing pond pair and transfer ownership.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - device_id
              properties:
                name:
                  type: string
                  maxLength: 30
                  description: Name for this pond pair (unique per user)
                  example: "Main Production Pair"
                device_id:
                  type: string
                  description: MAC address of the ESP32 device (XX:XX:XX:XX:XX:XX)
                  example: "AA:BB:CC:DD:EE:FF"
                pond_names:
                  type: array
                  items:
                    type: string
                    maxLength: 15
                  description: List of pond names to create (1-2 ponds)
                  example: ["Pond 1", "Pond 2"]
            examples:
              new_pair:
                summary: Create new pond pair with 2 ponds
                value:
                  name: "Main Production Pair"
                  device_id: "AA:BB:CC:DD:EE:FF"
                  pond_names: ["Pond 1", "Pond 2"]
              single_pond:
                summary: Create new pond pair with 1 pond
                value:
                  name: "Secondary Pair"
                  device_id: "11:22:33:44:55:66"
                  pond_names: ["Single Pond"]
      responses:
        '200':
          description: Pond pair reactivated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond pair re-registered successfully"
                  pond_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Pond pair name
                        example: "Main Production Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "AA:BB:CC:DD:EE:FF"
                      owner:
                        type: integer
                        description: Owner user ID
                        example: 1
                      ponds:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Pond ID
                              example: 1
                            name:
                              type: string
                              description: Pond name
                              example: "Pond 1"
                            is_active:
                              type: boolean
                              description: Whether pond is active
                              example: true
                      pond_count:
                        type: integer
                        description: Number of ponds
                        example: 2
                      is_complete:
                        type: boolean
                        description: Whether pair has exactly 2 ponds
                        example: true
              examples:
                success:
                  summary: Successful reactivation
                  value:
                    message: "Pond pair re-registered successfully"
                    pond_pair:
                      id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                      owner: 1
                      ponds:
                        - id: 1
                          name: "Pond 1"
                          is_active: true
                        - id: 2
                          name: "Pond 2"
                          is_active: true
                      pond_count: 2
                      is_complete: true
        '201':
          description: Pond pair created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond pair ID
                    example: 1
                  name:
                    type: string
                    description: Pond pair name
                    example: "Main Production Pair"
                  device_id:
                    type: string
                    description: Device MAC address
                    example: "AA:BB:CC:DD:EE:FF"
                  owner:
                    type: integer
                    description: Owner user ID
                    example: 1
                  ponds:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Pond ID
                          example: 1
                        name:
                          type: string
                          description: Pond name
                          example: "Pond 1"
                        is_active:
                          type: boolean
                          description: Whether pond is active
                          example: true
                  pond_count:
                    type: integer
                    description: Number of ponds
                    example: 2
                  is_complete:
                    type: boolean
                    description: Whether pair has exactly 2 ponds
                    example: true
              examples:
                success:
                  summary: Successful creation
                  value:
                    id: 1
                    name: "Main Production Pair"
                    device_id: "AA:BB:CC:DD:EE:FF"
                    owner: 1
                    ponds:
                      - id: 1
                        name: "Pond 1"
                        is_active: true
                      - id: 2
                        name: "Pond 2"
                        is_active: true
                    pond_count: 2
                    is_complete: true
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Pond pair name is required"
                  device_id:
                    type: array
                    items:
                      type: string
                    description: Device ID validation errors
                    example: ["This field is required."]
                  name:
                    type: array
                    items:
                      type: string
                    description: Name validation errors
                    example: ["A pond pair with this name already exists for your account."]
              examples:
                missing_name:
                  summary: Missing pond pair name
                  value:
                    error: "Pond pair name is required"
                duplicate_name:
                  summary: Duplicate pond pair name
                  value:
                    name: ["A pond pair with this name already exists for your account."]
                device_already_registered:
                  summary: Device already registered to another user
                  value:
                    device_id: ["This device is already registered to another user."]
  
  /ponds/{pk}/details/:
    get:
      tags:
        - Ponds
      summary: Get pond pair with detailed information
      description: |
        **üêü Retrieve comprehensive pond pair information with controls and sensor data**
        
        This endpoint returns detailed information about a pond pair including
        controls, sensor readings, and comprehensive pond details.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond pair
        
        **Response includes:**
        - Complete pond pair information
        - Full pond details with controls and sensor data
        - Device and ownership information
        - Real-time status indicators
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond pair ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Detailed pond pair information retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond pair ID
                    example: 1
                  name:
                    type: string
                    description: Pond pair name
                    example: "Main Production Pair"
                  device_id:
                    type: string
                    description: Device MAC address
                    example: "AA:BB:CC:DD:EE:FF"
                  owner:
                    type: integer
                    description: Owner user ID
                    example: 1
                  ponds:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Pond ID
                          example: 1
                        name:
                          type: string
                          description: Pond name
                          example: "Pond 1"
                        is_active:
                          type: boolean
                          description: Whether pond is active
                          example: true
                        controls:
                          type: array
                          items:
                            type: object
                          description: Pond control devices
                        sensor_readings:
                          type: array
                          items:
                            type: object
                          description: Recent sensor readings
                  pond_count:
                    type: integer
                    description: Number of ponds
                    example: 2
                  is_complete:
                    type: boolean
                    description: Whether pair has exactly 2 ponds
                    example: true
              examples:
                success:
                  summary: Successful detailed retrieval
                  value:
                    id: 1
                    name: "Main Production Pair"
                    device_id: "AA:BB:CC:DD:EE:FF"
                    owner: 1
                    ponds:
                      - id: 1
                        name: "Pond 1"
                        is_active: true
                        controls: []
                        sensor_readings: []
                      - id: 2
                        name: "Pond 2"
                        is_active: true
                        controls: []
                        sensor_readings: []
                    pond_count: 2
                    is_complete: true
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond pair not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'


  /ponds/{pond_pair_id}/add-pond/:
    post:
      tags:
        - Ponds
      summary: Add a pond to an existing pond pair
      description: |
        **‚ûï Add a new pond to an existing pond pair**
        
        This endpoint allows users to add a new pond to an existing pond pair.
        Each pond pair can have a maximum of 2 ponds.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond pair
        
        **Required Fields:** name (optional, will auto-generate if not provided)
        **Limitations:** Maximum 2 ponds per pair
        
        **Note:** If no name is provided, a default name will be generated.
      security:
        - BearerAuth: []
      parameters:
        - name: pond_pair_id
          in: path
          required: true
          description: Pond pair ID
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 15
                  description: Name for the new pond (optional, will auto-generate if not provided)
                  example: "New Pond"
            examples:
              with_name:
                summary: Add pond with specific name
                value:
                  name: "New Pond"
              auto_name:
                summary: Add pond with auto-generated name
                value: {}
      responses:
        '200':
          description: Pond added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond pair ID
                    example: 1
                  name:
                    type: string
                    description: Pond pair name
                    example: "Main Production Pair"
                  device_id:
                    type: string
                    description: Device MAC address
                    example: "AA:BB:CC:DD:EE:FF"
                  ponds:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Pond ID
                          example: 1
                        name:
                          type: string
                          description: Pond name
                          example: "Pond 1"
                        is_active:
                          type: boolean
                          description: Whether pond is active
                          example: true
                  pond_count:
                    type: integer
                    description: Updated pond count
                    example: 2
                  is_complete:
                    type: boolean
                    description: Whether pair now has exactly 2 ponds
                    example: true
              examples:
                success:
                  summary: Successful pond addition
                  value:
                    id: 1
                    name: "Main Production Pair"
                    device_id: "AA:BB:CC:DD:EE:FF"
                    ponds:
                      - id: 1
                        name: "Pond 1"
                        is_active: true
                      - id: 2
                        name: "New Pond"
                        is_active: true
                    pond_count: 2
                    is_complete: true
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "This pond pair already has 2 ponds and cannot accept more"
              examples:
                max_ponds_reached:
                  summary: Maximum ponds reached
                  value:
                    error: "This pond pair already has 2 ponds and cannot accept more"
                duplicate_name:
                  summary: Duplicate pond name
                  value:
                    error: 'You already have an active pond named "New Pond"'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond pair not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /ponds/{pond_pair_id}/remove-pond/{pond_id}/:
    post:
      tags:
        - Ponds
      summary: Remove a pond from a pond pair
      description: |
        **‚ûñ Remove a pond from an existing pond pair**
        
        This endpoint allows users to remove a pond from a pond pair.
        The pond is deactivated rather than deleted to preserve data.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond pair
        
        **Limitations:** Cannot remove the last active pond from a pair
        
        **Note:** The pond is deactivated, not deleted, to preserve historical data.
      security:
        - BearerAuth: []
      parameters:
        - name: pond_pair_id
          in: path
          required: true
          description: Pond pair ID
          schema:
            type: integer
            example: 1
        - name: pond_id
          in: path
          required: true
          description: Pond ID to remove
          schema:
            type: integer
            example: 2
      responses:
        '200':
          description: Pond removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond New Pond removed from pair Main Production Pair"
              examples:
                success:
                  summary: Successful pond removal
                  value:
                    message: "Pond New Pond removed from pair Main Production Pair"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Cannot remove the last active pond from a pair"
              examples:
                last_pond:
                  summary: Cannot remove last pond
                  value:
                    error: "Cannot remove the last active pond from a pair"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond pair or pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /ponds/device/{device_id}/:
    get:
      tags:
        - Ponds
      summary: Get pond pair by device ID
      description: |
        **üîç Retrieve pond pair information by device ID**
        
        This endpoint allows users to find a pond pair using the device's
        MAC address instead of the pond pair ID.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond pair
        
        **Use case:** Useful when you know the device ID but not the pond pair ID
        
        **Response includes:**
        - Complete pond pair information
        - All pond details
        - Device and ownership information
      security:
        - BearerAuth: []
      parameters:
        - name: device_id
          in: path
          required: true
          description: Device MAC address (XX:XX:XX:XX:XX:XX)
          schema:
            type: string
            example: "AA:BB:CC:DD:EE:FF"
      responses:
        '200':
          description: Pond pair found successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond pair ID
                    example: 1
                  name:
                    type: string
                    description: Pond pair name
                    example: "Main Production Pair"
                  device_id:
                    type: string
                    description: Device MAC address
                    example: "AA:BB:CC:DD:EE:FF"
                  owner:
                    type: integer
                    description: Owner user ID
                    example: 1
                  ponds:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Pond ID
                          example: 1
                        name:
                          type: string
                          description: Pond name
                          example: "Pond 1"
                        is_active:
                          type: boolean
                          description: Whether pond is active
                          example: true
                  pond_count:
                    type: integer
                    description: Number of ponds
                    example: 2
                  is_complete:
                    type: boolean
                    description: Whether pair has exactly 2 ponds
                    example: true
              examples:
                success:
                  summary: Successful device lookup
                  value:
                    id: 1
                    name: "Main Production Pair"
                    device_id: "AA:BB:CC:DD:EE:FF"
                    owner: 1
                    ponds:
                      - id: 1
                        name: "Pond 1"
                        is_active: true
                      - id: 2
                        name: "Pond 2"
                        is_active: true
                    pond_count: 2
                    is_complete: true
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond pair not found for this device
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /ponds/ponds/:
    get:
      tags:
        - Ponds
      summary: Get user's ponds
      description: |
        **üêü Retrieve all ponds owned by the authenticated user**
        
        This endpoint returns a list of all ponds across all pond pairs
        owned by the user, with basic information about each pond.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access ponds they own
        
        **Query Parameters:**
        - include_inactive: Whether to include inactive ponds (default: false)
        
        **Response includes:**
        - Pond basic information (name, status, creation date)
        - Parent pond pair information
        - Active/inactive status
      security:
        - BearerAuth: []
      parameters:
        - name: include_inactive
          in: query
          required: false
          description: Include inactive ponds in results
          schema:
            type: boolean
            default: false
            example: true
      responses:
        '200':
          description: Ponds retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Pond ID
                      example: 1
                    name:
                      type: string
                      description: Pond name
                      example: "Pond 1"
                    pond:
                      type: integer
                      description: Pond ID (for test compatibility)
                      example: 1
                    parent_pair:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Parent pond pair ID
                          example: 1
                        name:
                          type: string
                          description: Parent pond pair name
                          example: "Main Production Pair"
                        device_id:
                          type: string
                          description: Device MAC address
                          example: "AA:BB:CC:DD:EE:FF"
                    is_active:
                      type: boolean
                      description: Whether pond is active
                      example: true
                    created_at:
                      type: string
                      format: date-time
                      description: Creation timestamp
                      example: "2024-01-15T10:30:00Z"
              examples:
                success:
                  summary: Successful ponds retrieval
                  value:
                    - id: 1
                      name: "Pond 1"
                      pond: 1
                      parent_pair:
                        id: 1
                        name: "Main Production Pair"
                        device_id: "AA:BB:CC:DD:EE:FF"
                      is_active: true
                      created_at: "2024-01-15T10:30:00Z"
                    - id: 2
                      name: "Pond 2"
                      pond: 2
                      parent_pair:
                        id: 1
                        name: "Main Production Pair"
                        device_id: "AA:BB:CC:DD:EE:FF"
                      is_active: true
                      created_at: "2024-01-15T10:30:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /ponds/ponds/{pk}/:
    get:
      tags:
        - Ponds
      summary: Get pond details
      description: |
        **üêü Retrieve detailed information about a specific pond**
        
        This endpoint returns comprehensive details about a specific pond
        including its status, parent pair, and creation information.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Response includes:**
        - Complete pond information
        - Parent pond pair details
        - Status and creation timestamps
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Pond details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond ID
                    example: 1
                  name:
                    type: string
                    description: Pond name
                    example: "Pond 1"
                  parent_pair:
                    type: integer
                    description: Parent pond pair ID
                    example: 1
                  is_active:
                    type: boolean
                    description: Whether pond is active
                    example: true
                  created_at:
                    type: string
                    format: date-time
                    description: Creation timestamp
                    example: "2024-01-15T10:30:00Z"
              examples:
                success:
                  summary: Successful pond details retrieval
                  value:
                    id: 1
                    name: "Pond 1"
                    parent_pair: 1
                    is_active: true
                    created_at: "2024-01-15T10:30:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
    
    patch:
      tags:
        - Ponds
      summary: Update pond details
      description: |
        **‚úèÔ∏è Update pond information**
        
        This endpoint allows users to modify pond details including
        name and active status.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Note:** Only include the fields you want to update. All fields are optional for updates.
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 15
                  description: New name for the pond
                  example: "Updated Pond Name"
                is_active:
                  type: boolean
                  description: Whether the pond should be active
                  example: true
            examples:
              update_name:
                summary: Update pond name
                value:
                  name: "Updated Pond Name"
              update_status:
                summary: Update pond status
                value:
                  is_active: false
      responses:
        '200':
          description: Pond updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond ID
                    example: 1
                  name:
                    type: string
                    description: Updated pond name
                    example: "Updated Pond Name"
                  parent_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Parent pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Parent pond pair name
                        example: "Main Production Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "AA:BB:CC:DD:EE:FF"
                  is_active:
                    type: boolean
                    description: Whether pond is active
                    example: true
                  created_at:
                    type: string
                    format: date-time
                    description: Creation timestamp
                    example: "2024-01-15T10:30:00Z"
                  controls:
                    type: array
                    items:
                      type: object
                    description: Pond control devices
                    example: []
              examples:
                success:
                  summary: Successful pond update
                  value:
                    id: 1
                    name: "Updated Pond Name"
                    parent_pair:
                      id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                    is_active: true
                    created_at: "2024-01-15T10:30:00Z"
                    controls: []
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
    
    delete:
      tags:
        - Ponds
      summary: Delete a pond
      description: |
        **üóëÔ∏è Delete a pond from its parent pair**
        
        This endpoint permanently removes a pond from its parent pair.
        This action cannot be undone.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Limitations:** Cannot delete the last pond from a pair
        
        **Warning:** This action cannot be undone. All pond data will be permanently lost.
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      responses:
        '204':
          description: Pond deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond deleted successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Cannot delete the last pond from a pair"
              examples:
                last_pond:
                  summary: Cannot delete last pond
                  value:
                    error: "Cannot delete the last pond from a pair"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "System user not found"
              examples:
                system_user_error:
                  summary: System user not found
                  value:
                    error: "System user not found"

  /ponds/ponds/register/:
    post:
      tags:
        - Ponds
      summary: Register a new pond
      description: |
        **üêü Register a new pond with device**
        
        This endpoint allows users to register new ponds with devices.
        It can create new pond pairs or reactivate existing ones.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must have pond registration privileges
        
        **Required Fields:** device_id, name
        **Optional Fields:** pond_names (1-2 pond names)
        
        **Note:** If device_id already exists and is owned by system user,
        this will reactivate the existing pond pair and transfer ownership.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - device_id
                - name
              properties:
                device_id:
                  type: string
                  description: MAC address of the ESP32 device (XX:XX:XX:XX:XX:XX)
                  example: "AA:BB:CC:DD:EE:FF"
                name:
                  type: string
                  maxLength: 30
                  description: Name for this pond pair (unique per user)
                  example: "New Production Pair"
                pond_names:
                  type: array
                  items:
                    type: string
                    maxLength: 15
                  description: List of pond names to create (1-2 ponds)
                  example: ["Pond 1", "Pond 2"]
            examples:
              new_registration:
                summary: Register new pond pair
                value:
                  device_id: "AA:BB:CC:DD:EE:FF"
                  name: "New Production Pair"
                  pond_names: ["Pond 1", "Pond 2"]
              reactivation:
                summary: Reactivate existing pond pair
                value:
                  device_id: "11:22:33:44:55:66"
                  name: "Reactivated Pair"
                  pond_names: ["Single Pond"]
      responses:
        '200':
          description: Pond pair reactivated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond pair reactivated successfully"
                  pond_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Pond pair name
                        example: "Reactivated Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "11:22:33:44:55:66"
                      owner:
                        type: integer
                        description: Owner user ID
                        example: 1
                      ponds:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Pond ID
                              example: 1
                            name:
                              type: string
                              description: Pond name
                              example: "Single Pond"
                            is_active:
                              type: boolean
                              description: Whether pond is active
                              example: true
                      pond_count:
                        type: integer
                        description: Number of ponds
                        example: 1
                      is_complete:
                        type: boolean
                        description: Whether pair has exactly 2 ponds
                        example: false
              examples:
                success:
                  summary: Successful reactivation
                  value:
                    message: "Pond pair reactivated successfully"
                    pond_pair:
                      id: 1
                      name: "Reactivated Pair"
                      device_id: "11:22:33:44:55:66"
                      owner: 1
                      ponds:
                        - id: 1
                          name: "Single Pond"
                          is_active: true
                      pond_count: 1
                      is_complete: false
        '201':
          description: Pond pair created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond pair created successfully"
                  pond_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Pond pair name
                        example: "New Production Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "AA:BB:CC:DD:EE:FF"
                      owner:
                        type: integer
                        description: Owner user ID
                        example: 1
                      ponds:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Pond ID
                              example: 1
                            name:
                              type: string
                              description: Pond name
                              example: "Pond 1"
                            is_active:
                              type: boolean
                              description: Whether pond is active
                              example: true
                      pond_count:
                        type: integer
                        description: Number of ponds
                        example: 2
                      is_complete:
                        type: boolean
                        description: Whether pair has exactly 2 ponds
                        example: true
              examples:
                success:
                  summary: Successful creation
                  value:
                    message: "Pond pair created successfully"
                    pond_pair:
                      id: 1
                      name: "New Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                      owner: 1
                      ponds:
                        - id: 1
                          name: "Pond 1"
                          is_active: true
                        - id: 2
                          name: "Pond 2"
                          is_active: true
                      pond_count: 2
                      is_complete: true
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Failed to register pond"
                  device_id:
                    type: array
                    items:
                      type: string
                    description: Device ID validation errors
                    example: ["This field is required."]
                  name:
                    type: array
                    items:
                      type: string
                    description: Name validation errors
                    example: ["This field is required."]
              examples:
                missing_fields:
                  summary: Missing required fields
                  value:
                    device_id: ["This field is required."]
                    name: ["This field is required."]
                device_already_registered:
                  summary: Device already registered to another user
                  value:
                    device_id: ["This device is already registered to another user."]
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  /ponds/ponds/{pond_id}/feed-stats/:
    get:
      tags:
        - Ponds
      summary: Get feed statistics for a pond
      description: |
        **üìä Retrieve feed statistics for a specific pond**
        
        This endpoint returns comprehensive feed statistics for a pond
        across different time periods (daily, weekly, monthly, yearly).
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Query Parameters:**
        - stat_type: Filter by specific stat type (daily, weekly, monthly, yearly)
        
        **Response includes:**
        - Feed statistics grouped by time period
        - Amount and timing information
        - Total record counts
        - Pond identification details
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
        - name: stat_type
          in: query
          required: false
          description: Filter by specific stat type
          schema:
            type: string
            enum: ["daily", "weekly", "monthly", "yearly"]
            example: "daily"
      responses:
        '200':
          description: Feed statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  pond_id:
                    type: integer
                    description: Pond ID
                    example: 1
                  pond_name:
                    type: string
                    description: Pond name
                    example: "Pond 1"
                  feed_statistics:
                    type: object
                    properties:
                      daily:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Stat record ID
                              example: 1
                            stat_type:
                              type: string
                              description: Stat type
                              example: "daily"
                            amount:
                              type: number
                              format: float
                              description: Feed amount
                              example: 25.5
                            start_date:
                              type: string
                              format: date
                              description: Start date for period
                              example: "2024-08-29"
                            updated_at:
                              type: string
                              format: date-time
                              description: Last update timestamp
                              example: "2024-08-29T15:45:00Z"
                      weekly:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Stat record ID
                              example: 2
                            stat_type:
                              type: string
                              description: Stat type
                              example: "weekly"
                            amount:
                              type: number
                              format: float
                              description: Feed amount
                              example: 175.0
                            start_date:
                              type: string
                              format: date
                              description: Start date for period
                              example: "2024-08-26"
                            updated_at:
                              type: string
                              format: date-time
                              description: Last update timestamp
                              example: "2024-08-29T15:45:00Z"
                      monthly:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Stat record ID
                              example: 3
                            stat_type:
                              type: string
                              description: Stat type
                              example: "monthly"
                            amount:
                              type: number
                              format: float
                              description: Feed amount
                              example: 750.0
                            start_date:
                              type: string
                              format: date
                              description: Start date for period
                              example: "2024-08-01"
                            updated_at:
                              type: string
                              format: date-time
                              description: Last update timestamp
                              example: "2024-08-29T15:45:00Z"
                      yearly:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: Stat record ID
                              example: 4
                            stat_type:
                              type: string
                              description: Stat type
                              example: "yearly"
                            amount:
                              type: number
                              format: float
                              description: Feed amount
                              example: 8500.0
                            start_date:
                              type: string
                              format: date
                              description: Start date for period
                              example: "2024-01-01"
                            updated_at:
                              type: string
                              format: date-time
                              description: Last update timestamp
                              example: "2024-08-29T15:45:00Z"
                  total_records:
                    type: integer
                    description: Total number of feed stat records
                    example: 4
              examples:
                success:
                  summary: Successful feed stats retrieval
                  value:
                    pond_id: 1
                    pond_name: "Pond 1"
                    feed_statistics:
                      daily:
                        - id: 1
                          stat_type: "daily"
                          amount: 25.5
                          start_date: "2024-08-29"
                          updated_at: "2024-08-29T15:45:00Z"
                      weekly:
                        - id: 2
                          stat_type: "weekly"
                          amount: 175.0
                          start_date: "2024-08-26"
                          updated_at: "2024-08-29T15:45:00Z"
                      monthly:
                        - id: 3
                          stat_type: "monthly"
                          amount: 750.0
                          start_date: "2024-08-01"
                          updated_at: "2024-08-29T15:45:00Z"
                      yearly:
                        - id: 4
                          stat_type: "yearly"
                          amount: 8500.0
                          start_date: "2024-01-01"
                          updated_at: "2024-08-29T15:45:00Z"
                    total_records: 4
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Invalid stat_type. Must be one of: daily, weekly, monthly, yearly"
              examples:
                invalid_stat_type:
                  summary: Invalid stat type parameter
                  value:
                    error: "Invalid stat_type. Must be one of: daily, weekly, monthly, yearly"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # =============================================================================
  # PONDS SECTION COMPLETE
  # =============================================================================
  
  # =============================================================================
  # USERS APP ENDPOINTS
  # =============================================================================
  
  # User Authentication
  /users/register/:
    post:
      tags:
        - Users - Authentication
      summary: Register a new user
      description: |
        **üë§ Create a new user account**
        
        This endpoint allows new users to create an account with the system.
        Upon successful registration, the user receives JWT tokens for immediate authentication.
        
        **Authentication Required:** No (public endpoint)
        **Permissions:** None required
        
        **Required Fields:** username, password, password2, email, first_name, last_name
        **Password Requirements:** Must meet Django's password validation rules
        
        **Response includes:**
        - User account information
        - JWT access and refresh tokens
        - Success confirmation message
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - password2
                - email
                - first_name
                - last_name
              properties:
                username:
                  type: string
                  description: Unique username for the account
                  example: "johndoe"
                password:
                  type: string
                  description: User's password (must meet validation requirements)
                  example: "SecurePass123!"
                password2:
                  type: string
                  description: Password confirmation (must match password)
                  example: "SecurePass123!"
                email:
                  type: string
                  format: email
                  description: User's email address (must be unique)
                  example: "john.doe@example.com"
                first_name:
                  type: string
                  description: User's first name
                  example: "John"
                last_name:
                  type: string
                  description: User's last name
                  example: "Doe"
            examples:
              new_user:
                summary: Register new user account
                value:
                  username: "johndoe"
                  password: "SecurePass123!"
                  password2: "SecurePass123!"
                  email: "john.doe@example.com"
                  first_name: "John"
                  last_name: "Doe"
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "User registered successfully"
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: User ID
                        example: 1
                      username:
                        type: string
                        description: Username
                        example: "johndoe"
                      email:
                        type: string
                        description: Email address
                        example: "john.doe@example.com"
                      first_name:
                        type: string
                        description: First name
                        example: "John"
                      last_name:
                        type: string
                        description: Last name
                        example: "Doe"
                  refresh:
                    type: string
                    description: JWT refresh token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                  access:
                    type: string
                    description: JWT access token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
              examples:
                success:
                  summary: Successful user registration
                  value:
                    message: "User registered successfully"
                    user:
                      id: 1
                      username: "johndoe"
                      email: "john.doe@example.com"
                      first_name: "John"
                      last_name: "Doe"
                    refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  username:
                    type: array
                    items:
                      type: string
                    description: Username validation errors
                    example: ["A user with this username already exists."]
                  email:
                    type: array
                    items:
                      type: string
                    description: Email validation errors
                    example: ["A user with this email already exists."]
                  password:
                    type: array
                    items:
                      type: string
                    description: Password validation errors
                    example: ["This password is too short. It must contain at least 8 characters."]
                  password2:
                    type: array
                    items:
                      type: string
                    description: Password confirmation errors
                    example: ["Password fields didn't match."]
              examples:
                duplicate_username:
                  summary: Username already exists
                  value:
                    username: ["A user with this username already exists."]
                duplicate_email:
                  summary: Email already exists
                  value:
                    email: ["A user with this email already exists."]
                password_mismatch:
                  summary: Passwords don't match
                  value:
                    password2: ["Password fields didn't match."]
                weak_password:
                  summary: Password too weak
                  value:
                    password: ["This password is too short. It must contain at least 8 characters."]
  
  /users/login/:
    post:
      tags:
        - Users - Authentication
      summary: User login
      description: |
        **üîê Authenticate user and obtain JWT tokens**
        
        This endpoint authenticates users and provides JWT tokens for API access.
        Users can login with either username or email address.
        
        **Authentication Required:** No (public endpoint)
        **Permissions:** None required
        
        **Required Fields:** username (or email), password
        
        **Response includes:**
        - JWT access and refresh tokens
        - User profile information
        - Pond pairs summary (if user has ponds)
        - Authentication status
        
        **Note:** The username field accepts either username or email address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  description: Username or email address
                  example: "johndoe"
                password:
                  type: string
                  description: User's password
                  example: "SecurePass123!"
            examples:
              username_login:
                summary: Login with username
                value:
                  username: "johndoe"
                  password: "SecurePass123!"
              email_login:
                summary: Login with email
                value:
                  username: "john.doe@example.com"
                  password: "SecurePass123!"
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access:
                    type: string
                    description: JWT access token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                  refresh:
                    type: string
                    description: JWT refresh token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: User ID
                        example: 1
                      username:
                        type: string
                        description: Username
                        example: "johndoe"
                      email:
                        type: string
                        description: Email address
                        example: "john.doe@example.com"
                      first_name:
                        type: string
                        description: First name
                        example: "John"
                      last_name:
                        type: string
                        description: Last name
                        example: "Doe"
                  has_pond_pairs:
                    type: boolean
                    description: Whether user has pond pairs
                    example: true
                  pond_pairs_count:
                    type: integer
                    description: Number of pond pairs owned
                    example: 2
                  total_ponds_count:
                    type: integer
                    description: Total number of ponds across all pairs
                    example: 4
              examples:
                success_with_ponds:
                  summary: Successful login with ponds
                  value:
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    user:
                      id: 1
                      username: "johndoe"
                      email: "john.doe@example.com"
                      first_name: "John"
                      last_name: "Doe"
                    has_pond_pairs: true
                    pond_pairs_count: 2
                    total_ponds_count: 4
                success_no_ponds:
                  summary: Successful login without ponds
                  value:
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    user:
                      id: 1
                      username: "johndoe"
                      email: "john.doe@example.com"
                      first_name: "John"
                      last_name: "Doe"
                    has_pond_pairs: false
                    pond_pairs_count: 0
                    total_ponds_count: 0
        '400':
          description: Bad request - missing credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Invalid credentials"
              examples:
                missing_credentials:
                  summary: Missing username or password
                  value:
                    error: "Invalid credentials"
        '401':
          description: Unauthorized - invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Invalid credentials"
              examples:
                invalid_credentials:
                  summary: Invalid username or password
                  value:
                    error: "Invalid credentials"
  
  /users/token/refresh/:
    post:
      tags:
        - Users - Authentication
      summary: Refresh access token
      description: |
        **üîÑ Refresh JWT access token**
        
        This endpoint allows users to obtain a new access token using their refresh token.
        Useful when the access token expires but the refresh token is still valid.
        
        **Authentication Required:** No (public endpoint)
        **Permissions:** None required
        
        **Required Fields:** refresh
        
        **Response includes:**
        - New JWT access token
        
        **Note:** Refresh tokens have a longer lifespan than access tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refresh
              properties:
                refresh:
                  type: string
                  description: JWT refresh token
                  example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
            examples:
              refresh_token:
                summary: Refresh access token
                value:
                  refresh: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access:
                    type: string
                    description: New JWT access token
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
              examples:
                success:
                  summary: Successful token refresh
                  value:
                    access: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
        '400':
          description: Bad request - missing or invalid refresh token
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Refresh token is required"
              examples:
                missing_token:
                  summary: Missing refresh token
                  value:
                    error: "Refresh token is required"
                invalid_token:
                  summary: Invalid refresh token
                  value:
                    error: "Invalid refresh token"
  
  /users/logout/:
    post:
      tags:
        - Users - Authentication
      summary: User logout
      description: |
        **üö™ Logout user and invalidate tokens**
        
        This endpoint logs out the user and blacklists their refresh token.
        The blacklisted token can no longer be used to refresh access tokens.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must be authenticated
        
        **Required Fields:** refresh_token (optional, but recommended)
        
        **Response includes:**
        - Success confirmation message
        
        **Note:** Blacklisting the refresh token ensures it cannot be reused
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  description: JWT refresh token to blacklist
                  example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
            examples:
              with_refresh_token:
                summary: Logout with refresh token
                value:
                  refresh_token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
              without_refresh_token:
                summary: Logout without refresh token
                value: {}
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Logged out successfully"
              examples:
                success:
                  summary: Successful logout
                  value:
                    message: "Logged out successfully"
        '400':
          description: Bad request - invalid refresh token
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Invalid refresh token"
              examples:
                invalid_token:
                  summary: Invalid refresh token
                  value:
                    error: "Invalid refresh token"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
  
  # User Profile Management
  /users/profile/:
    get:
      tags:
        - Users - Profile
      summary: Get user profile
      description: |
        **üë§ Retrieve user profile information**
        
        This endpoint returns the authenticated user's profile information.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access their own profile
        
        **Response includes:**
        - User ID, username, email
        - First and last name
        - Profile creation and update timestamps
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: User ID
                    example: 1
                  username:
                    type: string
                    description: Username
                    example: "johndoe"
                  email:
                    type: string
                    description: Email address
                    example: "john.doe@example.com"
                  first_name:
                    type: string
                    description: First name
                    example: "John"
                  last_name:
                    type: string
                    description: Last name
                    example: "Doe"
              examples:
                success:
                  summary: Successful profile retrieval
                  value:
                    id: 1
                    username: "johndoe"
                    email: "john.doe@example.com"
                    first_name: "John"
                    last_name: "Doe"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
  
  /users/update-profile/:
    get:
      tags:
        - Users - Profile
      summary: Get user profile for editing
      description: |
        **üë§ Retrieve user profile for editing**
        
        This endpoint returns the authenticated user's profile information
        for display in profile editing forms.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access their own profile
        
        **Response includes:**
        - User ID, username, email
        - First and last name
        - Profile creation and update timestamps
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: User ID
                    example: 1
                  username:
                    type: string
                    description: Username
                    example: "johndoe"
                  email:
                    type: string
                    description: Email address
                    example: "john.doe@example.com"
                  first_name:
                    type: string
                    description: First name
                    example: "John"
                  last_name:
                    type: string
                    description: Last name
                    example: "Doe"
              examples:
                success:
                  summary: Successful profile retrieval
                  value:
                    id: 1
                    username: "johndoe"
                    email: "john.doe@example.com"
                    first_name: "John"
                    last_name: "Doe"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
    
    put:
      tags:
        - Users - Profile
      summary: Update user profile
      description: |
        **‚úèÔ∏è Update user profile information**
        
        This endpoint allows users to update their profile information.
        Only the provided fields will be updated.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only update their own profile
        
        **Optional Fields:** username, email, first_name, last_name
        
        **Note:** Username and email must be unique across all users
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: New username (must be unique)
                  example: "newusername"
                email:
                  type: string
                  format: email
                  description: New email address (must be unique)
                  example: "newemail@example.com"
                first_name:
                  type: string
                  description: New first name
                  example: "Jane"
                last_name:
                  type: string
                  description: New last name
                  example: "Smith"
            examples:
              update_username:
                summary: Update username
                value:
                  username: "newusername"
              update_email:
                summary: Update email
                value:
                  email: "newemail@example.com"
              update_names:
                summary: Update first and last names
                value:
                  first_name: "Jane"
                  last_name: "Smith"
              full_update:
                summary: Update all fields
                value:
                  username: "newusername"
                  email: "newemail@example.com"
                  first_name: "Jane"
                  last_name: "Smith"
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Profile updated successfully"
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: User ID
                        example: 1
                      username:
                        type: string
                        description: Updated username
                        example: "newusername"
                      email:
                        type: string
                        description: Updated email address
                        example: "newemail@example.com"
                      first_name:
                        type: string
                        description: Updated first name
                        example: "Jane"
                      last_name:
                        type: string
                        description: Updated last name
                        example: "Smith"
              examples:
                success:
                  summary: Successful profile update
                  value:
                    message: "Profile updated successfully"
                    user:
                      id: 1
                      username: "newusername"
                      email: "newemail@example.com"
                      first_name: "Jane"
                      last_name: "Smith"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                duplicate_username:
                  summary: Username already exists
                  value:
                    username: ["A user with this username already exists."]
                duplicate_email:
                  summary: Email already exists
                  value:
                    email: ["A user with this email already exists."]
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
    
    patch:
      tags:
        - Users - Profile
      summary: Partially update user profile
      description: |
        **‚úèÔ∏è Partially update user profile information**
        
        This endpoint allows users to update specific fields in their profile.
        Only the provided fields will be updated.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only update their own profile
        
        **Optional Fields:** username, email, first_name, last_name
        
        **Note:** This is an alias for the PUT method
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: New username (must be unique)
                  example: "newusername"
                email:
                  type: string
                  format: email
                  description: New email address (must be unique)
                  example: "newemail@example.com"
                first_name:
                  type: string
                  description: New first name
                  example: "Jane"
                last_name:
                  type: string
                  description: New last name
                  example: "Smith"
            examples:
              partial_update:
                summary: Update only email
                value:
                  email: "newemail@example.com"
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Profile updated successfully"
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: User ID
                        example: 1
                      username:
                        type: string
                        description: Username
                        example: "johndoe"
                      email:
                        type: string
                        description: Updated email address
                        example: "newemail@example.com"
                      first_name:
                        type: string
                        description: First name
                        example: "John"
                      last_name:
                        type: string
                        description: Last name
                        example: "Doe"
              examples:
                success:
                  summary: Successful partial update
                  value:
                    message: "Profile updated successfully"
                    user:
                      id: 1
                      username: "johndoe"
                      email: "newemail@example.com"
                      first_name: "John"
                      last_name: "Doe"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
  
  /users/change-password/:
    post:
      tags:
        - Users - Profile
      summary: Change user password
      description: |
        **üîí Change user password**
        
        This endpoint allows authenticated users to change their password.
        The current password must be verified before the new password is set.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only change their own password
        
        **Required Fields:** current_password, new_password
        
        **Password Requirements:** New password must meet Django's validation rules
        
        **Response includes:**
        - Success confirmation message
        
        **Note:** Password change requires current password verification for security
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - current_password
                - new_password
              properties:
                current_password:
                  type: string
                  description: User's current password
                  example: "OldPass123!"
                new_password:
                  type: string
                  description: New password (must meet validation requirements)
                  example: "NewSecurePass456!"
            examples:
              change_password:
                summary: Change password
                value:
                  current_password: "OldPass123!"
                  new_password: "NewSecurePass456!"
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Password changed successfully"
              examples:
                success:
                  summary: Successful password change
                  value:
                    message: "Password changed successfully"
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Both current_password and new_password are required"
              examples:
                missing_fields:
                  summary: Missing required fields
                  value:
                    error: "Both current_password and new_password are required"
                incorrect_current:
                  summary: Incorrect current password
                  value:
                    error: "Current password is incorrect"
                weak_new_password:
                  summary: New password too weak
                  value:
                    error: "This password is too short. It must contain at least 8 characters."
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
  
  # User Pond Management
  /users/ponds/:
    get:
      tags:
        - Users - Ponds
      summary: Get user's ponds
      description: |
        **üêü Retrieve all ponds owned by the authenticated user**
        
        This endpoint returns a list of all ponds across all pond pairs
        owned by the authenticated user.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access their own ponds
        
        **Response includes:**
        - Pond basic information (name, status, creation date)
        - Parent pond pair information
        - Active/inactive status
        - Pond control devices
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Ponds retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Pond ID
                      example: 1
                    name:
                      type: string
                      description: Pond name
                      example: "Main Production Pond"
                    parent_pair:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Parent pond pair ID
                          example: 1
                        name:
                          type: string
                          description: Parent pond pair name
                          example: "Main Production Pair"
                        device_id:
                          type: string
                          description: Device MAC address
                          example: "AA:BB:CC:DD:EE:FF"
                    is_active:
                      type: boolean
                      description: Whether pond is active
                      example: true
                    created_at:
                      type: string
                      format: date-time
                      description: Creation timestamp
                      example: "2024-01-15T10:30:00Z"
                    controls:
                      type: array
                      items:
                        type: object
                      description: Pond control devices
                      example: []
              examples:
                success:
                  summary: Successful ponds retrieval
                  value:
                    - id: 1
                      name: "Main Production Pond"
                      parent_pair:
                        id: 1
                        name: "Main Production Pair"
                        device_id: "AA:BB:CC:DD:EE:FF"
                      is_active: true
                      created_at: "2024-01-15T10:30:00Z"
                      controls: []
                    - id: 2
                      name: "Secondary Pond"
                      parent_pair:
                        id: 1
                        name: "Main Production Pair"
                        device_id: "AA:BB:CC:DD:EE:FF"
                      is_active: true
                      created_at: "2024-01-15T10:30:00Z"
                      controls: []
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
  
  /users/ponds/{pk}/:
    get:
      tags:
        - Users - Ponds
      summary: Get specific pond details
      description: |
        **üêü Retrieve detailed information about a specific pond**
        
        This endpoint returns comprehensive details about a specific pond
        owned by the authenticated user.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Response includes:**
        - Complete pond information
        - Parent pond pair details
        - Status and creation timestamps
        - Control devices
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Pond details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond ID
                    example: 1
                  name:
                    type: string
                    description: Pond name
                    example: "Main Production Pond"
                  parent_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Parent pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Parent pond pair name
                        example: "Main Production Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "AA:BB:CC:DD:EE:FF"
                  is_active:
                    type: boolean
                    description: Whether pond is active
                    example: true
                  created_at:
                    type: string
                    format: date-time
                    description: Creation timestamp
                    example: "2024-01-15T10:30:00Z"
                  controls:
                    type: array
                    items:
                      type: object
                    description: Pond control devices
                    example: []
              examples:
                success:
                  summary: Successful pond details retrieval
                  value:
                    id: 1
                    name: "Main Production Pond"
                    parent_pair:
                      id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                    is_active: true
                    created_at: "2024-01-15T10:30:00Z"
                    controls: []
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
    
    put:
      tags:
        - Users - Ponds
      summary: Update pond information
      description: |
        **‚úèÔ∏è Update pond information**
        
        This endpoint allows users to modify pond details including
        name and other configurable properties.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Note:** Only include the fields you want to update. All fields are optional for updates.
        
        **Limitations:** Cannot update is_active status directly
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 15
                  description: New name for the pond
                  example: "Updated Pond Name"
            examples:
              update_name:
                summary: Update pond name
                value:
                  name: "Updated Pond Name"
      responses:
        '200':
          description: Pond updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: Pond ID
                    example: 1
                  name:
                    type: string
                    description: Updated pond name
                    example: "Updated Pond Name"
                  parent_pair:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Parent pond pair ID
                        example: 1
                      name:
                        type: string
                        description: Parent pond pair name
                        example: "Main Production Pair"
                      device_id:
                        type: string
                        description: Device MAC address
                        example: "AA:BB:CC:DD:EE:FF"
                  is_active:
                    type: boolean
                    description: Whether pond is active
                    example: true
                  created_at:
                    type: string
                    format: date-time
                    description: Creation timestamp
                    example: "2024-01-30T10:30:00Z"
                  controls:
                    type: array
                    items:
                      type: object
                    description: Pond control devices
                    example: []
              examples:
                success:
                  summary: Successful pond update
                  value:
                    id: 1
                    name: "Updated Pond Name"
                    parent_pair:
                      id: 1
                      name: "Main Production Pair"
                      device_id: "AA:BB:CC:DD:EE:FF"
                    is_active: true
                    created_at: "2024-01-15T10:30:00Z"
                    controls: []
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "You already have an active pond named 'Updated Pond Name'. Please use a different name."
              examples:
                duplicate_name:
                  summary: Duplicate pond name
                  value:
                    error: "You already have an active pond named 'Updated Pond Name'. Please use a different name."
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
    
    delete:
      tags:
        - Users - Ponds
      summary: Delete pond
      description: |
        **üóëÔ∏è Delete a pond (transfer to system user and deactivate)**
        
        This endpoint deletes a pond by transferring ownership to the system user
        and deactivating it. This preserves data while removing user access.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own this pond
        
        **Note:** The pond is not permanently deleted, but transferred to system user
        
        **Response includes:**
        - Success confirmation message
        - Pond ID that was deleted
      security:
        - BearerAuth: []
      parameters:
        - name: pk
          in: path
          required: true
          description: Pond ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Pond deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "Pond deleted successfully"
                  pond_id:
                    type: integer
                    description: ID of deleted pond
                    example: 1
              examples:
                success:
                  summary: Successful pond deletion
                  value:
                    message: "Pond deleted successfully"
                    pond_id: 1
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PermissionError'
        '404':
          description: Pond not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "System user not found"
              examples:
                system_user_error:
                  summary: System user not found
                  value:
                    error: "System user not found"

  # =============================================================================
  # USERS SECTION COMPLETE
  # =============================================================================
  
  # The users app endpoints have been fully documented above.
  # This includes:
  # - User authentication (register, login, logout, token refresh)
  # - User profile management (view, update, password change)
  # - User pond management (list, view, update, delete)
  # - Comprehensive error handling and examples
  #
  # Next sections to be added:
  # - Analytics app endpoints
  # - Dashboard app endpoints
  # - Core app endpoints
  #
  # Each section will follow the same comprehensive documentation pattern
  # with detailed schemas, examples, and error responses.
  #
  # =============================================================================
  
  # =============================================================================
  # ANALYTICS APP ENDPOINTS
  # =============================================================================
  
  # Current Sensor Data
  /analytics/current-data/:
    get:
      tags:
        - Analytics - Current Data
      summary: Get current sensor data for a specific pond
      description: |
        **üìä Retrieve real-time sensor data for a specific pond**
        
        This endpoint provides the most recent sensor readings for a pond,
        including temperature, water level, turbidity, dissolved oxygen,
        pH, and feed level.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond
        
        **Use Cases:**
        - Real-time dashboard monitoring
        - Current pond status display
        - Immediate sensor reading access
        - Live data visualization
        
        **Response includes:**
        - Latest sensor readings with timestamps
        - All sensor parameters (temperature, water_level, turbidity, etc.)
        - Data formatting (rounded decimals, integer water levels)
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: query
          required: true
          description: ID of the pond to get sensor data for
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Current sensor data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  current_data:
                    type: object
                    properties:
                      temperature:
                        type: number
                        format: float
                        description: Water temperature in Celsius (rounded to 2 decimal places)
                        example: 25.67
                      water_level:
                        type: integer
                        description: Water level percentage (0-100)
                        example: 85
                      turbidity:
                        type: number
                        format: float
                        description: Water turbidity in NTU (rounded to 2 decimal places)
                        example: 12.34
                      dissolved_oxygen:
                        type: number
                        format: float
                        description: Dissolved oxygen in mg/L (rounded to 2 decimal places)
                        example: 7.89
                      ph:
                        type: number
                        format: float
                        description: pH level (rounded to 2 decimal places)
                        example: 7.23
                      feed_level:
                        type: number
                        format: float
                        description: Feed level percentage (rounded to 2 decimal places)
                        example: 75.50
                      timestamp:
                        type: string
                        format: date-time
                        description: When the sensor reading was taken
                        example: "2024-01-15T14:30:00Z"
              examples:
                success:
                  summary: Successful current data retrieval
                  value:
                    current_data:
                      temperature: 25.67
                      water_level: 85
                      turbidity: 12.34
                      dissolved_oxygen: 7.89
                      ph: 7.23
                      feed_level: 75.50
                      timestamp: "2024-01-15T14:30:00Z"
        '400':
          description: Bad request - missing or invalid pond_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "pond_id query parameter is required."
              examples:
                missing_pond_id:
                  summary: Missing pond_id parameter
                  value:
                    detail: "pond_id query parameter is required."
                invalid_pond_id:
                  summary: Invalid pond_id format
                  value:
                    detail: "pond_id must be a valid integer."
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied - user doesn't own the pond
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "You do not have permission to access this pond's data."
              examples:
                access_denied:
                  summary: User doesn't own the pond
                  value:
                    detail: "You do not have permission to access this pond's data."
        '404':
          description: Pond not found or no sensor data available
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "No sensor data available for this pond."
              examples:
                no_data:
                  summary: No sensor data available
                  value:
                    detail: "No sensor data available for this pond."
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # Historical Sensor Data
  /analytics/historical-data/:
    get:
      tags:
        - Analytics - Historical Data
      summary: Get historical sensor data aggregated by time intervals
      description: |
        **üìà Retrieve time-series sensor data for trend analysis**
        
        This endpoint provides historical sensor data aggregated into meaningful
        time intervals for trend analysis and visualization.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond
        
        **Time Range Options:**
        - **24h**: 24 hourly intervals (1-hour granularity)
        - **1w**: 28 intervals of 6 hours each (6-hour granularity)
        - **1m**: 30 daily intervals (24-hour granularity)
        
        **Use Cases:**
        - Trend analysis and pattern recognition
        - Historical performance monitoring
        - Data visualization and charts
        - Environmental condition tracking
        - Performance optimization insights
        
        **Data Aggregation:**
        - Uses Django's Avg() aggregation for each sensor metric
        - Only includes intervals with actual sensor readings
        - Skips empty intervals to maintain data quality
        - All values rounded to 2 decimal places (except water_level as integer)
        
        **Response includes:**
        - Time-series data with timestamps
        - Aggregated sensor readings for each interval
        - Time range specification
        - Sensor parameters: temperature, water_level, turbidity, dissolved_oxygen, ph, feed_level
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: query
          required: true
          description: ID of the pond to get historical data for
          schema:
            type: integer
            example: 1
        - name: range
          in: query
          required: false
          description: Time range for historical data
          schema:
            type: string
            enum: ["24h", "1w", "1m"]
            default: "24h"
            example: "24h"
      responses:
        '200':
          description: Historical data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  historical_data:
                    type: array
                    items:
                      type: object
                      properties:
                        timestamp:
                          type: string
                          format: date-time
                          description: Start time of the data interval
                          example: "2024-01-15T10:00:00Z"
                        temperature:
                          type: number
                          format: float
                          description: Average temperature in Celsius for the interval
                          example: 25.67
                        water_level:
                          type: integer
                          description: Average water level percentage for the interval
                          example: 85
                        turbidity:
                          type: number
                          format: float
                          description: Average turbidity in NTU for the interval
                          example: 12.34
                        dissolved_oxygen:
                          type: number
                          format: float
                          description: Average dissolved oxygen in mg/L for the interval
                          example: 7.89
                        ph:
                          type: number
                          format: float
                          description: Average pH level for the interval
                          example: 7.23
                        feed_level:
                          type: number
                          format: float
                          description: Average feed level percentage for the interval
                          example: 75.50
                  time_range:
                    type: string
                    description: The time range used for data aggregation
                    example: "24h"
              examples:
                hourly_data:
                  summary: 24-hour hourly data
                  value:
                    historical_data:
                      - timestamp: "2024-01-15T10:00:00Z"
                        temperature: 25.67
                        water_level: 85
                        turbidity: 12.34
                        dissolved_oxygen: 7.89
                        ph: 7.23
                        feed_level: 75.50
                      - timestamp: "2024-01-15T11:00:00Z"
                        temperature: 26.12
                        water_level: 84
                        turbidity: 11.89
                        dissolved_oxygen: 8.01
                        ph: 7.18
                        feed_level: 74.20
                    time_range: "24h"
                weekly_data:
                  summary: 1-week 6-hour intervals
                  value:
                    historical_data:
                      - timestamp: "2024-01-09T00:00:00Z"
                        temperature: 24.50
                        water_level: 88
                        turbidity: 13.20
                        dissolved_oxygen: 7.45
                        ph: 7.30
                        feed_level: 78.90
                    time_range: "1w"
        '400':
          description: Bad request - missing or invalid parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message for missing pond_id
                    example: "pond_id query parameter is required."
                  detail:
                    type: string
                    description: Error message for invalid range
                    example: "Invalid range parameter. Use '24h', '1w', or '1m'."
              examples:
                missing_pond_id:
                  summary: Missing pond_id parameter
                  value:
                    error: "pond_id query parameter is required."
                invalid_range:
                  summary: Invalid range parameter
                  value:
                    detail: "Invalid range parameter. Use '24h', '1w', or '1m'."
                invalid_pond_id:
                  summary: Invalid pond_id format
                  value:
                    detail: "pond_id must be a valid integer."
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied - user doesn't own the pond
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "You do not have permission to access this pond's data."
              examples:
                access_denied:
                  summary: User doesn't own the pond
                  value:
                    detail: "You do not have permission to access this pond's data."
        '404':
          description: Pond not found or no sensor data available
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "No sensor data available for the specified time range."
              examples:
                no_data:
                  summary: No sensor data available
                  value:
                    detail: "No sensor data available for the specified time range."
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # User Ponds Dropdown
  /analytics/user-ponds/:
    get:
      tags:
        - Analytics - User Ponds
      summary: Get user's ponds for dropdown selection
      description: |
        **üêü Retrieve user's ponds for analytics interface**
        
        This endpoint provides a list of all active ponds owned by the
        authenticated user for use in dropdown menus and pond selection.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User can only access their own ponds
        
        **Use Cases:**
        - Analytics dashboard pond selection
        - Data visualization pond picker
        - Multi-pond data comparison
        - User interface navigation
        
        **Response includes:**
        - List of user's active ponds
        - Pond ID and name for each pond
        - Optimized for dropdown/select components
        
        **Note:** Only returns active ponds to ensure data availability
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User's ponds retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Pond ID
                      example: 1
                    name:
                      type: string
                      description: Pond name
                      example: "Main Production Pond"
              examples:
                success:
                  summary: Successful ponds retrieval
                  value:
                    - id: 1
                      name: "Main Production Pond"
                    - id: 2
                      name: "Secondary Pond"
                    - id: 3
                      name: "Nursery Pond"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'
  
  # Dashboard Data
  /analytics/dashboard-data/:
    get:
      tags:
        - Analytics - Dashboard
      summary: Get comprehensive dashboard data for a specific pond
      description: |
        **üìä Retrieve comprehensive dashboard data for pond monitoring**
        
        This endpoint provides both current sensor readings and historical
        summary data for comprehensive dashboard displays.
        
        **Authentication Required:** Yes (JWT Bearer token)
        **Permissions:** User must own the pond
        
        **Use Cases:**
        - Main dashboard overview
        - Comprehensive pond status display
        - Real-time monitoring with historical context
        - Performance tracking and analysis
        - Environmental condition assessment
        
        **Response includes:**
        - Current sensor readings (real-time)
        - Historical summary (24-hour averages)
        - Pond information (ID, name, status)
        - Combined data for comprehensive monitoring
        
        **Data Aggregation:**
        - Current data: Latest sensor reading
        - Historical summary: 24-hour averages for all sensor parameters
        - Optimized for dashboard display and real-time monitoring
      security:
        - BearerAuth: []
      parameters:
        - name: pond_id
          in: query
          required: true
          description: ID of the pond to get dashboard data for
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Dashboard data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  current_data:
                    type: object
                    properties:
                      temperature:
                        type: number
                        format: float
                        description: Current water temperature in Celsius
                        example: 25.67
                      water_level:
                        type: integer
                        description: Current water level percentage
                        example: 85
                      turbidity:
                        type: number
                        format: float
                        description: Current water turbidity in NTU
                        example: 12.34
                      dissolved_oxygen:
                        type: number
                        format: float
                        description: Current dissolved oxygen in mg/L
                        example: 7.89
                      ph:
                        type: number
                        format: float
                        description: Current pH level
                        example: 7.23
                      feed_level:
                        type: number
                        format: float
                        description: Current feed level percentage
                        example: 75.50
                      timestamp:
                        type: string
                        format: date-time
                        description: When the current reading was taken
                        example: "2024-01-15T14:30:00Z"
                  historical_summary:
                    type: object
                    properties:
                      avg_temperature:
                        type: number
                        format: float
                        description: 24-hour average temperature
                        example: 25.45
                      avg_water_level:
                        type: number
                        format: float
                        description: 24-hour average water level
                        example: 84.67
                      avg_turbidity:
                        type: number
                        format: float
                        description: 24-hour average turbidity
                        example: 12.89
                      avg_dissolved_oxygen:
                        type: number
                        format: float
                        description: 24-hour average dissolved oxygen
                        example: 7.92
                      avg_ph:
                        type: number
                        format: float
                        description: 24-hour average pH
                        example: 7.21
                      avg_feed_level:
                        type: number
                        format: float
                        description: 24-hour average feed level
                        example: 76.23
                  pond_info:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: Pond ID
                        example: 1
                      name:
                        type: string
                        description: Pond name
                        example: "Main Production Pond"
                      is_active:
                        type: boolean
                        description: Whether the pond is active
                        example: true
              examples:
                success:
                  summary: Successful dashboard data retrieval
                  value:
                    current_data:
                      temperature: 25.67
                      water_level: 85
                      turbidity: 12.34
                      dissolved_oxygen: 7.89
                      ph: 7.23
                      feed_level: 75.50
                      timestamp: "2024-01-15T14:30:00Z"
                    historical_summary:
                      avg_temperature: 25.45
                      avg_water_level: 84.67
                      avg_turbidity: 12.89
                      avg_dissolved_oxygen: 7.92
                      avg_ph: 7.21
                      avg_feed_level: 76.23
                    pond_info:
                      id: 1
                      name: "Main Production Pond"
                      is_active: true
        '400':
          description: Bad request - missing or invalid pond_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "pond_id query parameter is required."
              examples:
                missing_pond_id:
                  summary: Missing pond_id parameter
                  value:
                    detail: "pond_id query parameter is required."
                invalid_pond_id:
                  summary: Invalid pond_id format
                  value:
                    detail: "pond_id must be a valid integer."
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticationError'
        '403':
          description: Access denied - user doesn't own the pond
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "You do not have permission to access this pond's data."
              examples:
                access_denied:
                  summary: User doesn't own the pond
                  value:
                    detail: "You do not have permission to access this pond's data."
        '404':
          description: Pond not found or no sensor data available
          content:
            application/json:
              schema:
                type: object
                properties:
                  detail:
                    type: string
                    description: Error message
                    example: "No sensor data available for this pond."
              examples:
                no_data:
                  summary: No sensor data available
                  value:
                    detail: "No sensor data available for this pond."
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerError'

  # =============================================================================
  # ANALYTICS SECTION COMPLETE
  # =============================================================================
  
  # The analytics app endpoints have been fully documented above.
  # This includes:
  # - Current sensor data retrieval (real-time readings)
  # - Historical data aggregation (time-series analysis)
  # - User ponds dropdown (interface navigation)
  # - Comprehensive dashboard data (combined current + historical)
  # - Detailed error handling and examples
  # - Time range options and data aggregation logic
  #
  # Next sections to be added:
  # - Dashboard app endpoints
  # - Core app endpoints
  #
  # Each section will follow the same comprehensive documentation pattern
  # with detailed schemas, examples, and error responses.
  #
  # =============================================================================
